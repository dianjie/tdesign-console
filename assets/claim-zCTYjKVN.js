import{d as E,aC as H,f as g,i as W,l as j,r as l,as as G,o as m,c as d,a as t,w as o,b as s,q as r,e as J,W as v,t as Q,s as X,ab as Y,M as Z,at as ee}from"./index-CqGaQ7t4.js";import{a as te,b as oe}from"./work-EOGau8jX.js";import{_ as ae}from"./index.vue_vue_type_script_setup_true_lang-ojmq6q2F.js";import{u as ne}from"./useSetting-CnYQd1RY.js";import{u as se}from"./useDesign-CbWcZHFZ.js";import{u as le}from"./useRequset-Bj5fiv5N.js";import{g as ie,f as re}from"./flowHelper-BpDILVBW.js";import{u as V}from"./index-BidCcHov.js";import"./flow-DzSZmebQ.js";const ce=[{colKey:"serial-number",title:"序号",width:80,align:"center",fixed:"left"},{title:"流程分类",colKey:"categoryName"},{title:"流程名称",colKey:"processDefinitionName"},{title:"当前步骤",colKey:"taskName"},{title:"流程版本",colKey:"processDefinitionVersion"},{title:"申请时间",colKey:"createTime"},{fixed:"right",width:200,colKey:"op",title:"操作",align:"center"}],ue={class:"table-wrapper"},me=["onClick"],de=["onClick"],pe=["onClick"],Ce=E({__name:"claim",setup(fe){const{tableVar:x}=se(),{getTableHeaderAffixedTop:N,getLayoutContainer:S}=ne(),F={category:"",processDefinitionName:""},b=H(),i=g({...F}),K=b.getFlowDict,{fetchData:R,data:$,pagination:p,dataLoading:I}=le(te,i.value,ee),y=()=>{R({...i.value,category:ie(i.value.category)})};W(()=>{y()});const c=V(()=>{y()},300),T=a=>{p.value={...p.value,current:a.current||1,pageSize:a.pageSize},c()},f=g(!1),w=g({}),L=({row:a})=>{w.value=a,f.value=!0},B=j(),M=({row:a})=>{B.push({path:`/work/process/${re(b.getFlowRoutes,a.category)}/detail/${a.processInstanceId}/${a.businessId}`})},U=({row:a})=>{const e=Y.confirm({header:"提示",theme:"info",body:"确定签收此任务?",onConfirm:V(async()=>{await oe(a.taskId),Z.success("删除成功"),e.destroy(),c()},300)})};return(a,e)=>{const z=l("t-select"),D=l("t-form-item"),u=l("t-col"),q=l("t-input"),h=l("t-row"),k=l("t-button"),O=l("t-form"),P=l("t-tag"),A=l("t-table"),_=G("auth");return m(),d("div",{class:X(s(x))},[t(O,{ref:"form",data:i.value,"label-width":80,colon:"",style:{marginBottom:"8px"},onReset:s(c),onSubmit:s(c)},{default:o(()=>[t(h,null,{default:o(()=>[t(u,{span:10},{default:o(()=>[t(h,{gutter:[16,24]},{default:o(()=>[t(u,{span:4},{default:o(()=>[t(D,{label:"流程分类",name:"category"},{default:o(()=>[t(z,{modelValue:i.value.category,"onUpdate:modelValue":e[0]||(e[0]=n=>i.value.category=n),options:s(K),keys:{value:"dictKey",label:"dictValue"},clearable:"",placeholder:"请选择流程分类"},null,8,["modelValue","options"])]),_:1})]),_:1}),t(u,{span:4},{default:o(()=>[t(D,{label:"流程名称",name:"processDefinitionName"},{default:o(()=>[t(q,{modelValue:i.value.processDefinitionName,"onUpdate:modelValue":e[1]||(e[1]=n=>i.value.processDefinitionName=n),clearable:"",placeholder:"请输入流程名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(u,{span:2,class:"operation-wrapper"},{default:o(()=>[t(k,{theme:"primary",type:"submit",style:{marginLeft:"8px"}},{default:o(()=>e[3]||(e[3]=[r(" 查询 ")])),_:1}),t(k,{type:"reset",variant:"base",theme:"default"},{default:o(()=>e[4]||(e[4]=[r(" 重置 ")])),_:1})]),_:1})]),_:1})]),_:1},8,["data","onReset","onSubmit"]),J("div",ue,[t(A,{data:s($),columns:s(ce),hover:!0,loading:s(I),pagination:s(p),"header-affixed-top":{offsetTop:s(N),container:s(S)},"vertical-align":"top","row-key":"id",bordered:"",stripe:"",onPageChange:T},{op:o(n=>[v((m(),d("a",{class:"t-button-link",onClick:C=>U(n)},e[5]||(e[5]=[r("签收")]),8,me)),[[_,"work_claim_sign"]]),v((m(),d("a",{class:"t-button-link",onClick:C=>M(n)},e[6]||(e[6]=[r("详情")]),8,de)),[[_,"work_claim_detail"]]),v((m(),d("a",{class:"t-button-link",onClick:C=>L(n)},e[7]||(e[7]=[r("流程图")]),8,pe)),[[_,"work_claim_follow"]])]),processDefinitionVersion:o(({row:n})=>[t(P,{theme:"primary",variant:"light"},{default:o(()=>[r("v"+Q(n.processDefinitionVersion),1)]),_:2},1024)]),_:1},8,["data","columns","loading","pagination","header-affixed-top"]),t(ae,{visible:f.value,"onUpdate:visible":e[2]||(e[2]=n=>f.value=n),"row-data":w.value,type:"diagram"},null,8,["visible","row-data"])])],2)}}});export{Ce as default};
