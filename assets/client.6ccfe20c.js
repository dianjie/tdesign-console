import{a1 as q,d as Z,r as m,C as W,ax as X,av as M,e as n,f as C,g as O,w as t,m as ne,l as e,q as ee,j as d,J as E,p as g,K as re,M as P,_ as te,a as se,aG as ie,i as G,n as de}from"./index.c2521a03.js";import{u as ce}from"./useDesign.9d0ca2bc.js";import{u as me}from"./useSetting.65510119.js";import{u as pe}from"./useRequset.5f7a0394.js";import{u as Y}from"./index.d71d3bee.js";const fe=(f,F,_)=>q.get({url:"/blade-system/client/list",params:{..._,current:f,size:F}}),ve=f=>q.get({url:"/blade-system/client/detail",params:{id:f}}),_e=f=>q.post({url:"/blade-system/client/remove",params:{ids:f}},{joinParamsToUrl:!0,errorMessageMode:"message"}),be=f=>q.post({url:"/blade-system/client/submit",data:f}),ye=[{colKey:"row-select",type:"multiple",width:64,fixed:"left"},{colKey:"serial-number",title:"\u5E8F\u53F7",width:80,align:"center",fixed:"left"},{title:"\u5E94\u7528ID",colKey:"clientId"},{title:"\u5E94\u7528\u5BC6\u94A5",colKey:"clientSecret"},{title:"\u6388\u6743\u7C7B\u578B",colKey:"authorizedGrantTypes"},{title:"\u6388\u6743\u8303\u56F4",colKey:"scope"},{title:"\u4EE4\u724C\u79D2\u6570",colKey:"accessTokenValidity"},{fixed:"right",width:180,colKey:"op",title:"\u64CD\u4F5C",align:"center"}],ge=[{label:"\u5168\u9009",checkAll:!0},{value:"refresh_token",label:"refresh_token"},{value:"password",label:"password"},{value:"authorization_code",label:"authorization_code"},{value:"captcha",label:"captcha"},{value:"social",label:"social"}],Fe=Z({__name:"DialogForm",props:{visible:{type:Boolean,default:!1},editId:{type:String,default:""},actionType:{type:String,default:""}},emits:["update:visible","update:editId","update:actionType","submit"],setup(f,{emit:F}){const _=f,S={clientId:"",clientSecret:"",authorizedGrantTypes:["refresh_token","password","authorization_code"],scope:"all",accessTokenValidity:3600,refreshTokenValidity:604800,webServerRedirectUri:"",resourceIds:"",authorities:"",autoapprove:"",additionalInformation:""},K=m({clientId:[{required:!0,message:"\u8BF7\u8F93\u5165\u5E94\u7528ID",type:"error",trigger:"blur"}],clientSecret:[{required:!0,message:"\u8BF7\u8F93\u5165\u5E94\u7528\u5BC6\u94A5",type:"error",trigger:"blur"}],authorizedGrantTypes:[{required:!0,message:"\u8BF7\u9009\u62E9\u6388\u6743\u7C7B\u578B",type:"error",trigger:"change"}],scope:[{required:!0,message:"\u8BF7\u8F93\u5165\u6388\u6743\u8303\u56F4",type:"error",trigger:"blur"}],accessTokenValidity:[{required:!0,message:"\u8BF7\u8F93\u5165\u4EE4\u724C\u79D2\u6570",type:"error",trigger:"blur"}],refreshTokenValidity:[{required:!0,message:"\u8BF7\u8F93\u5165\u5237\u65B0\u79D2\u6570",type:"error",trigger:"blur"}],webServerRedirectUri:[{required:!0,message:"\u8BF7\u8F93\u5165\u56DE\u8C03\u5730\u5740",type:"error",trigger:"blur"}]}),V=W(()=>`${{view:"\u67E5\u770B",edit:"\u7F16\u8F91",add:"\u65B0\u589E"}[_.actionType]||""}\u5E94\u7528`),b=W(()=>({view:!0,edit:!1})[_.actionType]||!1),c=m(!1),a=m({...S}),D=m(null),h=m(!1),x=({firstError:p})=>{if(p)P.warning(p);else{h.value=!0;const u={...a.value,authorizedGrantTypes:a.value.authorizedGrantTypes.join(","),id:_.editId};be(u).then(()=>{F("submit",u),P.success("\u63D0\u4EA4\u6210\u529F"),c.value=!1}).finally(()=>{h.value=!1})}},N=()=>{a.value={...S},M(()=>{F("update:editId",""),F("update:actionType","")})},w=()=>{c.value=!1};return X(()=>c.value,p=>{F("update:visible",p)}),X(()=>_.visible,p=>{p&&_.editId&&M(()=>{ve(_.editId).then(u=>{a.value={...u,authorizedGrantTypes:u.authorizedGrantTypes.split(",")}})}),M(()=>{var u;(u=D.value)==null||u.clearValidate()}),c.value=p}),(p,u)=>{const y=n("t-input"),o=n("t-form-item"),i=n("t-col"),j=n("t-checkbox-group"),$=n("t-input-number"),U=n("t-textarea"),A=n("t-button"),k=n("t-row"),B=n("t-form"),z=n("t-dialog");return C(),O(z,{visible:c.value,"onUpdate:visible":u[11]||(u[11]=l=>c.value=l),header:d(V),width:780,footer:!1,onClosed:N},{body:t(()=>[ne(" \u8868\u5355\u5185\u5BB9 "),e(B,{ref_key:"form",ref:D,class:ee({"xy-form__detail":f.actionType==="view"}),data:a.value,rules:K.value,"label-width":100,disabled:d(b)||h.value,onSubmit:x},{default:t(()=>[e(k,{gutter:[0,28]},{default:t(()=>[e(i,{span:6},{default:t(()=>[e(o,{label:"\u5E94\u7528ID",name:"clientId"},{default:t(()=>[e(y,{modelValue:a.value.clientId,"onUpdate:modelValue":u[0]||(u[0]=l=>a.value.clientId=l),placeholder:"\u8BF7\u8F93\u5165\u5E94\u7528ID",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:6},{default:t(()=>[e(o,{label:"\u5E94\u7528\u5BC6\u94A5",name:"clientSecret"},{default:t(()=>[e(y,{modelValue:a.value.clientSecret,"onUpdate:modelValue":u[1]||(u[1]=l=>a.value.clientSecret=l),placeholder:"\u8BF7\u8F93\u5165\u5E94\u7528\u5BC6\u94A5",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:6},{default:t(()=>[e(o,{label:"\u6388\u6743\u7C7B\u578B",name:"authorizedGrantTypes"},{default:t(()=>[e(j,{modelValue:a.value.authorizedGrantTypes,"onUpdate:modelValue":u[2]||(u[2]=l=>a.value.authorizedGrantTypes=l),options:d(ge),placeholder:"\u8BF7\u9009\u62E9\u6388\u6743\u7C7B\u578B"},null,8,["modelValue","options"])]),_:1})]),_:1}),e(i,{span:6},{default:t(()=>[e(o,{label:"\u6388\u6743\u8303\u56F4",name:"scope"},{default:t(()=>[e(y,{modelValue:a.value.scope,"onUpdate:modelValue":u[3]||(u[3]=l=>a.value.scope=l),placeholder:"\u8BF7\u8F93\u5165\u6388\u6743\u8303\u56F4",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:6},{default:t(()=>[e(o,{label:"\u4EE4\u724C\u79D2\u6570",name:"accessTokenValidity"},{default:t(()=>[e($,{modelValue:a.value.accessTokenValidity,"onUpdate:modelValue":u[4]||(u[4]=l=>a.value.accessTokenValidity=l),theme:"column",placeholder:"\u8BF7\u8F93\u5165\u4EE4\u724C\u79D2\u6570",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:6},{default:t(()=>[e(o,{label:"\u5237\u65B0\u79D2\u6570",name:"refreshTokenValidity"},{default:t(()=>[e($,{modelValue:a.value.refreshTokenValidity,"onUpdate:modelValue":u[5]||(u[5]=l=>a.value.refreshTokenValidity=l),theme:"column",placeholder:"\u8BF7\u8F93\u5165\u5237\u65B0\u79D2\u6570",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:6},{default:t(()=>[e(o,{label:"\u56DE\u8C03\u5730\u5740",name:"webServerRedirectUri"},{default:t(()=>[e(y,{modelValue:a.value.webServerRedirectUri,"onUpdate:modelValue":u[6]||(u[6]=l=>a.value.webServerRedirectUri=l),placeholder:"\u8BF7\u8F93\u5165\u56DE\u8C03\u5730\u5740",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:6},{default:t(()=>[e(o,{label:"\u8D44\u6E90\u96C6\u5408",name:"resourceIds"},{default:t(()=>[e(y,{modelValue:a.value.resourceIds,"onUpdate:modelValue":u[7]||(u[7]=l=>a.value.resourceIds=l),placeholder:"\u8BF7\u8F93\u5165\u8D44\u6E90\u96C6\u5408",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:6},{default:t(()=>[e(o,{label:"\u6743\u9650",name:"authorities"},{default:t(()=>[e(y,{modelValue:a.value.authorities,"onUpdate:modelValue":u[8]||(u[8]=l=>a.value.authorities=l),placeholder:"\u8BF7\u8F93\u5165\u6743\u9650",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:6},{default:t(()=>[e(o,{label:"\u81EA\u52A8\u6388\u6743",name:"autoapprove"},{default:t(()=>[e(y,{modelValue:a.value.autoapprove,"onUpdate:modelValue":u[9]||(u[9]=l=>a.value.autoapprove=l),placeholder:"\u8BF7\u8F93\u5165\u81EA\u52A8\u6388\u6743",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:6},{default:t(()=>[e(o,{label:"\u9644\u52A0\u8BF4\u660E",name:"additionalInformation"},{default:t(()=>[e(U,{modelValue:a.value.additionalInformation,"onUpdate:modelValue":u[10]||(u[10]=l=>a.value.additionalInformation=l),placeholder:"\u8BF7\u8F93\u5165\u9644\u52A0\u8BF4\u660E",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),E(e(i,{span:12},{default:t(()=>[e(o,{style:{float:"right"}},{default:t(()=>[e(A,{variant:"outline",onClick:w},{default:t(()=>[g("\u53D6\u6D88")]),_:1}),e(A,{theme:"primary",type:"submit"},{default:t(()=>[g("\u786E\u5B9A")]),_:1})]),_:1})]),_:1},512),[[re,!d(b)]])]),_:1})]),_:1},8,["class","data","rules","disabled"])]),_:1},8,["visible","header"])}}}),Ve=te(Fe,[["__file","D:/Study/tdesign-console/src/viewsBusiness/system/components/client/DialogForm.vue"]]),he={class:"table-wrapper"},Be=["onClick"],Ce=["onClick"],De=["onClick"],Ee=Z({__name:"client",setup(f){const{tableVar:F}=ce(),{getTableHeaderAffixedTop:_,getLayoutContainer:S}=me(),K={paramName:"",paramValue:""},V=m([]),b=m({...K}),c=m(!1),a=m(!1),D=m(""),h=m(""),{fetchData:x,data:N,pagination:w,dataLoading:p}=pe(fe,b.value,()=>{V.value=[]});se(()=>{x()});const u=({row:v},r)=>{D.value=v.id,h.value=r,a.value=!0},y=({row:v})=>{k.value=v.id,B.value="one",c.value=!0},o=Y(()=>{x()},300),i=v=>{V.value=v},j=v=>{w.value={...w.value,current:v.current||1,pageSize:v.pageSize},o()},U=Y(async v=>{try{await _e(v),c.value=!1,P.success("\u5220\u9664\u6210\u529F"),z(),o()}catch{c.value=!1}},300),A=()=>{!V.value.length||(B.value="check",c.value=!0)},k=m(-1),B=m(),z=()=>{k.value=-1,B.value=""},l=()=>{B.value==="check"&&U(V.value),B.value==="one"&&U([`${k.value}`])},ue=()=>{z()};return(v,r)=>{const H=n("t-input"),J=n("t-form-item"),T=n("t-col"),L=n("t-row"),R=n("t-button"),ae=n("t-form"),le=n("t-table"),oe=n("t-dialog"),I=ie("auth");return C(),G("div",{class:ee(d(F))},[e(ae,{ref:"form",data:b.value,"label-width":80,colon:"",style:{marginBottom:"8px"},onReset:d(o),onSubmit:d(o)},{default:t(()=>[e(L,null,{default:t(()=>[e(T,{span:10},{default:t(()=>[e(L,{gutter:[16,24]},{default:t(()=>[e(T,{span:4},{default:t(()=>[e(J,{label:"\u5E94\u7528ID",name:"paramName"},{default:t(()=>[e(H,{modelValue:b.value.paramName,"onUpdate:modelValue":r[0]||(r[0]=s=>b.value.paramName=s),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5E94\u7528ID"},null,8,["modelValue"])]),_:1})]),_:1}),e(T,{span:4},{default:t(()=>[e(J,{label:"\u5E94\u7528\u5BC6\u94A5",name:"paramValue"},{default:t(()=>[e(H,{modelValue:b.value.paramValue,"onUpdate:modelValue":r[1]||(r[1]=s=>b.value.paramValue=s),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5E94\u7528\u5BC6\u94A5"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(T,{span:2,class:"operation-wrapper"},{default:t(()=>[e(R,{theme:"primary",type:"submit",style:{marginLeft:"8px"}},{default:t(()=>[g(" \u67E5\u8BE2 ")]),_:1}),e(R,{type:"reset",variant:"base",theme:"default"},{default:t(()=>[g(" \u91CD\u7F6E ")]),_:1})]),_:1})]),_:1})]),_:1},8,["data","onReset","onSubmit"]),de("div",he,[e(le,{data:d(N),columns:d(ye),hover:!0,loading:d(p),pagination:d(w),"selected-row-keys":V.value,"header-affixed-top":{offsetTop:d(_),container:d(S)},"vertical-align":"top","row-key":"id",bordered:"",stripe:"",onPageChange:j,onSelectChange:i},{"top-content":t(()=>[e(L,{justify:"space-between",style:{"margin-bottom":"10px"}},{default:t(()=>[e(T,{flex:"0 0 auto"},{default:t(()=>[E((C(),O(R,{onClick:r[2]||(r[2]=s=>u({row:{}},"add"))},{default:t(()=>[g("\u65B0\u589E")]),_:1})),[[I,"client_add"]]),E((C(),O(R,{theme:"danger",onClick:A},{default:t(()=>[g("\u5220\u9664")]),_:1})),[[I,"client_delete"]])]),_:1})]),_:1})]),op:t(s=>[E((C(),G("a",{class:"t-button-link",onClick:Q=>u(s,"view")},[g("\u67E5\u770B")],8,Be)),[[I,"client_view"]]),E((C(),G("a",{class:"t-button-link",onClick:Q=>u(s,"edit")},[g("\u7F16\u8F91")],8,Ce)),[[I,"client_edit"]]),E((C(),G("a",{class:"t-button-link",onClick:Q=>y(s)},[g("\u5220\u9664")],8,De)),[[I,"client_delete"]])]),_:1},8,["data","columns","loading","pagination","selected-row-keys","header-affixed-top"]),e(oe,{visible:c.value,"onUpdate:visible":r[3]||(r[3]=s=>c.value=s),header:"\u786E\u8BA4\u5220\u9664\u5F53\u524D\u6240\u9009\u6570\u636E\uFF1F","on-cancel":ue,onConfirm:l},null,8,["visible"]),e(Ve,{visible:a.value,"onUpdate:visible":r[4]||(r[4]=s=>a.value=s),editId:D.value,"onUpdate:editId":r[5]||(r[5]=s=>D.value=s),actionType:h.value,"onUpdate:actionType":r[6]||(r[6]=s=>h.value=s),onSubmit:d(o)},null,8,["visible","editId","actionType","onSubmit"])])],2)}}}),xe=te(Ee,[["__file","D:/Study/tdesign-console/src/views/system/client.vue"]]);export{xe as default};
