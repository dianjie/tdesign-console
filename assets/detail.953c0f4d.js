import{d as Q,r as v,a2 as W,c as X,a3 as Y,C as A,a as Z,e as s,f as o,i as l,l as t,w as a,j as F,p as $,F as w,H as ee,m as r,q as te,a5 as ae,a6 as ue,a7 as se,g as oe,n as k,t as i,v as ne,x as le,_ as re}from"./index.c2521a03.js";import{u as ie}from"./useDesign.9d0ca2bc.js";import{u as ce}from"./useSetting.65510119.js";import{a as de}from"./leave.1af6143c.js";import{h as me}from"./process.14f0ef10.js";import{g as _e}from"./flow.34ecd32e.js";import{u as pe}from"./index.d71d3bee.js";const fe=m=>(ne("data-v-7bef7c66"),m=m(),le(),m),ve=fe(()=>k("div",{class:"form__title",style:{margin:"22px 0"}},"\u8BF7\u5047\u6D41\u7A0B\u8BE6\u60C5",-1)),Fe={class:"process_content"},ye={key:0},ge={key:1},he={key:2},be={key:3},Be={key:4},De={key:5},Ae={key:6},ke=["src"],Ie=Q({__name:"detail",setup(m){const{tableVar:I}=ie(),{getTableHeaderAffixedTop:T,getLayoutContainer:x}=ce(),E={assigneeName:"",startTime:"",endTime:"",reason:"",comment:""},V=v({comment:[{required:!0,message:"\u8BF7\u8F93\u5165\u6279\u590D\u610F\u89C1",type:"error",trigger:"blur"}]}),n=v({...E}),_=W(),C=X(),g=Y(),{tabRouters:N}=g,h=A(()=>_.params.processInstanceId||""),S=A(()=>_.params.businessId||""),U=pe(()=>{const c=N.findIndex(u=>u.path===_.path);g.subtractCurrentTabRouter({path:_.path,routeIdx:c}),C.replace({path:"/work/start"})},300),b=v([]),p=v(""),R=async()=>{const c=await de(S.value);n.value={...c,assigneeName:c.flow.assigneeName};const u=await me(h.value);b.value=u},L=()=>{const c=_e({processInstanceId:h.value});ae(c).then(u=>{p.value=ue(u)}).catch(()=>{p.value=se})};return Z(()=>{R(),L()}),(c,u)=>{const d=s("t-col"),j=s("t-button"),B=s("t-row"),q=s("t-affix"),H=s("t-input"),f=s("t-form-item"),D=s("t-date-picker"),z=s("t-textarea"),M=s("t-form"),y=s("t-collapse-panel"),G=s("t-comment"),J=s("t-list-item"),K=s("t-list"),O=s("t-collapse");return o(),l("div",{class:te(F(I))},[t(q,{ref:"affix","offset-top":F(T)+15,container:F(x)},{default:a(()=>[t(B,{justify:"space-between",align:"center",style:{position:"relative",top:"-15px","background-color":"#fff"}},{default:a(()=>[t(d,{flex:"0 0 auto"},{default:a(()=>[ve]),_:1}),t(d,{flex:"0 0 auto"},{default:a(()=>[t(j,{theme:"default",variant:"outline",onClick:F(U)},{default:a(()=>[$("\u5173\u95ED")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["offset-top","container"]),t(O,{"default-expand-all":!0},{default:a(()=>[t(y,{value:"0",header:"\u5BA1\u6279\u4FE1\u606F",class:"reset_panel-body-background"},{default:a(()=>[t(M,{ref:"form",data:n.value,"label-width":80,disabled:!0,rules:V.value},{default:a(()=>[t(B,{gutter:[0,28]},{default:a(()=>[t(d,{span:12},{default:a(()=>[t(f,{label:"\u7533\u8BF7\u4EBA",name:"assigneeName"},{default:a(()=>[t(H,{modelValue:n.value.assigneeName,"onUpdate:modelValue":u[0]||(u[0]=e=>n.value.assigneeName=e),placeholder:"\u8BF7\u8F93\u5165\u7533\u8BF7\u4EBA",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),t(d,{span:12},{default:a(()=>[t(f,{label:"\u5F00\u59CB\u65F6\u95F4",name:"startTime"},{default:a(()=>[t(D,{modelValue:n.value.startTime,"onUpdate:modelValue":u[1]||(u[1]=e=>n.value.startTime=e),"enable-time-picker":"","allow-input":"",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u5F00\u59CB\u65F6\u95F4",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),t(d,{span:12},{default:a(()=>[t(f,{label:"\u7ED3\u675F\u65F6\u95F4",name:"endTime"},{default:a(()=>[t(D,{modelValue:n.value.endTime,"onUpdate:modelValue":u[2]||(u[2]=e=>n.value.endTime=e),"enable-time-picker":"","allow-input":"",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u7ED3\u675F\u65F6\u95F4",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),t(d,{span:12},{default:a(()=>[t(f,{label:"\u8BF7\u5047\u7406\u7531",name:"reason"},{default:a(()=>[t(z,{modelValue:n.value.reason,"onUpdate:modelValue":u[3]||(u[3]=e=>n.value.reason=e),placeholder:"\u8BF7\u8F93\u5165\u8BF7\u5047\u7406\u7531"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["data","rules"])]),_:1}),t(y,{value:"1",header:"\u6D41\u7A0B\u4FE1\u606F",class:"reset_panel-body-background"},{default:a(()=>[t(K,{split:!0},{default:a(()=>[(o(!0),l(w,null,ee(b.value,(e,P)=>(o(),oe(J,{key:e.id},{content:a(()=>[t(G,{author:e.assigneeName,datetime:e.createTime},{content:a(()=>[k("div",Fe,[r(" historyActivityId \u6D41\u7A0B\u8282\u70B9\u7684\u4E3B\u952EID "),!e.assignee&&e.historyActivityId==="start"?(o(),l("p",ye," \u5728 ["+i(e.createTime)+"] \u53D1\u8D77\u6D41\u7A0B ",1)):r("v-if",!0),!e.assignee&&P!==0&&!e.endTime?(o(),l("p",ge," ["+i(e.historyActivityName)+"] \u73AF\u8282\u7B49\u5F85\u7B7E\u6536 ",1)):r("v-if",!0),!e.assignee&&e.historyActivityId==="end"&&e.endTime?(o(),l("p",he," ["+i(e.endTime)+"] \u6D41\u7A0B\u7ED3\u675F ",1)):r("v-if",!0),e.assignee?(o(),l("p",be," \u5728 ["+i(e.createTime)+"] \u5F00\u59CB\u5904\u7406 ["+i(e.historyActivityName)+"] \u73AF\u8282 ",1)):r("v-if",!0),e.historyActivityDurationTime!==""?(o(),l("p",Be," \u4EFB\u52A1\u5386\u65F6\uFF1A["+i(e.historyActivityDurationTime)+"] ",1)):r("v-if",!0),e.comment!==""?(o(),l("p",De,"\u6279\u590D\u610F\u89C1\uFF1A["+i(e.comment)+"]",1)):r("v-if",!0),e.endTime!==""&&e.assignee?(o(),l("p",Ae,"\u7ED3\u675F\u65F6\u95F4\uFF1A["+i(e.endTime)+"]",1)):r("v-if",!0)])]),_:2},1032,["author","datetime"])]),_:2},1024))),128))]),_:1})]),_:1}),t(y,{value:"2",header:"\u6D41\u7A0B\u8DDF\u8E2A",class:"reset_panel-body-background"},{default:a(()=>[p.value?(o(),l("img",{key:0,src:p.value,alt:"\u6D41\u7A0B\u8DDF\u8E2A",style:{display:"block",padding:"25px 0"}},null,8,ke)):r("v-if",!0)]),_:1})]),_:1})],2)}}});const Ue=re(Ie,[["__scopeId","data-v-7bef7c66"],["__file","D:/Study/tdesign-console/src/views/process/leave/detail.vue"]]);export{Ue as default};
