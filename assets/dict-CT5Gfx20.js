import{d as re,f as s,J as le,a2 as Q,Q as Z,aT as fe,r as n,o as w,m as A,w as t,a as e,s as me,W as $,q as y,X as be,aU as _e,M as E,aw as ge,aq as Ce,as as ye,b as g,e as te,p as de,c as J,aV as De,aW as Ve,aX as Se,i as he,t as Te}from"./index-CqGaQ7t4.js";import{u as xe}from"./useSetting-CnYQd1RY.js";import{u as Ie}from"./useDesign-CbWcZHFZ.js";import{u as we}from"./useRequset-Bj5fiv5N.js";import{u as se}from"./index-BidCcHov.js";const Ue=[{colKey:"row-select",type:"multiple",width:64,fixed:"left"},{colKey:"serial-number",title:"序号",width:80,align:"center",fixed:"left"},{title:"字典编号",colKey:"code"},{title:"字典名称",colKey:"dictValue"},{title:"字典键值",colKey:"dictKey"},{title:"字典排序",colKey:"sort"},{title:"封存",colKey:"isSealed"},{fixed:"right",width:250,colKey:"op",title:"操作",align:"center"}],Ke=re({__name:"DialogForm",props:{visible:{type:Boolean,default:!1},editId:{type:String,default:""},actionType:{type:String,default:""},rowData:{type:Object,default:()=>({})}},emits:["update:visible","update:editId","update:actionType","submit","closed"],setup(L,{emit:O}){const R={code:"",parentId:"",parentName:"",dictValue:"",dictKey:"",sort:void 0,isSealed:0,remark:""},m=L,h=s({code:[{required:!0,message:"请选择字典编号",type:"error",trigger:"blur"}],dictValue:[{required:!0,message:"请输入字典名称",type:"error",trigger:"blur"}],dictKey:[{required:!0,message:"请输入字典键值",type:"error",trigger:"blur"}],sort:[{required:!0,message:"请输入字典排序",type:"error",trigger:"blur"}],isSealed:[{required:!0,message:"请选择是否封存",type:"error",trigger:"change"}]}),M=le(()=>`${{view:"查看",edit:"编辑",add:"新增"}[m.actionType]||""}字典`),D=le(()=>({view:!0,edit:!1})[m.actionType]||!1),v=s(!1),a=s({...R}),T=s(null),V=s(!1),f=O,C=({firstError:d})=>{if(d)E.warning(d);else{V.value=!0;const l={...a.value,id:m.editId};_e(l).then(()=>{f("submit",l),E.success("提交成功"),v.value=!1}).finally(()=>{V.value=!1})}},x=()=>{a.value={...R},Z(()=>{f("update:editId",""),f("update:actionType",""),f("closed")})},U=()=>{v.value=!1};return Q(()=>v.value,d=>{f("update:visible",d)}),Q(()=>m.visible,d=>{d&&m.editId&&Z(()=>{fe(m.editId).then(l=>{a.value={...l}})}),Z(()=>{var l;(l=T.value)==null||l.clearValidate()}),v.value=d}),Q(()=>m.rowData,d=>{a.value={...a.value,parentId:d.id,parentName:d.dictValue,code:d.code}}),(d,l)=>{const I=n("t-input"),b=n("t-form-item"),_=n("t-col"),N=n("t-input-number"),S=n("t-switch"),z=n("t-textarea"),j=n("t-button"),B=n("t-row"),F=n("t-form"),G=n("t-dialog");return w(),A(G,{visible:v.value,"onUpdate:visible":l[7]||(l[7]=i=>v.value=i),header:M.value,width:780,footer:!1,onClosed:x},{body:t(()=>[e(F,{ref_key:"form",ref:T,class:me({"xy-form__detail":L.actionType==="view"}),data:a.value,rules:h.value,"label-width":100,disabled:D.value||V.value,onSubmit:C},{default:t(()=>[e(B,{gutter:[0,28]},{default:t(()=>[e(_,{span:12},{default:t(()=>[e(b,{label:"字典编号",name:"code"},{default:t(()=>[e(I,{modelValue:a.value.code,"onUpdate:modelValue":l[0]||(l[0]=i=>a.value.code=i),placeholder:"请输入字典编号",disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(b,{label:"上级字典",name:"parentName"},{default:t(()=>[e(I,{modelValue:a.value.parentName,"onUpdate:modelValue":l[1]||(l[1]=i=>a.value.parentName=i),placeholder:"请输入字典名称",disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(b,{label:"字典名称",name:"dictValue"},{default:t(()=>[e(I,{modelValue:a.value.dictValue,"onUpdate:modelValue":l[2]||(l[2]=i=>a.value.dictValue=i),placeholder:"请输入字典名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(b,{label:"字典键值",name:"dictKey"},{default:t(()=>[e(I,{modelValue:a.value.dictKey,"onUpdate:modelValue":l[3]||(l[3]=i=>a.value.dictKey=i),placeholder:"请输入字典键值",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(b,{label:"字典排序",name:"sort"},{default:t(()=>[e(N,{modelValue:a.value.sort,"onUpdate:modelValue":l[4]||(l[4]=i=>a.value.sort=i),theme:"column",placeholder:"请输入字典排序",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(b,{label:"封存",name:"isSealed"},{default:t(()=>[e(S,{modelValue:a.value.isSealed,"onUpdate:modelValue":l[5]||(l[5]=i=>a.value.isSealed=i),"custom-value":[1,0]},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(b,{label:"字典备注",name:"remark"},{default:t(()=>[e(z,{modelValue:a.value.remark,"onUpdate:modelValue":l[6]||(l[6]=i=>a.value.remark=i),placeholder:"请输入字典备注",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),$(e(_,{span:12},{default:t(()=>[e(b,{style:{float:"right"}},{default:t(()=>[e(j,{variant:"outline",onClick:U},{default:t(()=>l[8]||(l[8]=[y("取消")])),_:1}),e(j,{theme:"primary",type:"submit"},{default:t(()=>l[9]||(l[9]=[y("确定")])),_:1})]),_:1})]),_:1},512),[[be,!D.value]])]),_:1})]),_:1},8,["class","data","rules","disabled"])]),_:1},8,["visible","header"])}}}),$e={class:"table-wrapper"},Re=["onClick"],Ne=["onClick"],je=["onClick"],qe=["onClick"],Ae=re({__name:"DialogList",props:{visible:{type:Boolean,default:!1},rowData:{type:Object,default:()=>({})}},emits:["update:visible"],setup(L,{emit:O}){const{hasRole:R}=ge(),m=L,h=s({}),M=O,D=le(()=>`[${m.rowData.dictValue}]字典配置`),v={code:"",dictValue:""},a=s([]),T=Ce({childrenKey:"children",treeNodeColumnIndex:2}),V=s(!1),f=s({...v}),C=s(!1),x=s(!1),U=s(""),d=s(""),l=s(null),{fetchData:I,data:b,dataLoading:_}=we(De,{},()=>{a.value=[]},!1),N=()=>{I({...f.value,parentId:m.rowData.id})},S=({row:r},o)=>{U.value=r.id,d.value=o,x.value=!0},z=({row:r})=>{h.value=r,d.value="add",x.value=!0},j=({row:r})=>{Y.value=r.id,X.value="one",C.value=!0},B=se(()=>{N()},300),F=r=>{a.value=r},i=se(async r=>{try{await Ve(r),C.value=!1,E.success("删除成功"),ae(),B()}catch{C.value=!1}},300),W=()=>{a.value.length&&(X.value="check",C.value=!0)},Y=s(-1),X=s(),ae=()=>{Y.value=-1,X.value=""},k=()=>{X.value==="check"&&i(a.value),X.value==="one"&&i([`${Y.value}`])},u=()=>{ae()},oe=r=>{var K;const{parentId:o}=g(h.value);r.parentId!==o?N():r.id&&((K=l.value)==null||K.setData(r.id,{...h.value,...r}))},ne=()=>{h.value={...m.rowData}};return Q(()=>V.value,r=>{M("update:visible",r)}),Q(()=>m.visible,r=>{r&&m.rowData.id&&N(),V.value=r,h.value={...m.rowData}}),(r,o)=>{const K=n("t-input"),ie=n("t-form-item"),H=n("t-col"),P=n("t-row"),q=n("t-button"),p=n("t-form"),ee=n("t-icon"),pe=n("t-tag"),ke=n("t-enhanced-table"),ve=n("t-dialog"),ue=ye("auth");return w(),A(ve,{visible:V.value,"onUpdate:visible":o[7]||(o[7]=c=>V.value=c),header:D.value,width:980,footer:!1},{default:t(()=>[e(p,{ref:"form",data:f.value,"label-width":80,colon:"",style:{marginBottom:"8px"},onReset:g(B),onSubmit:g(B)},{default:t(()=>[e(P,null,{default:t(()=>[e(H,{span:10},{default:t(()=>[e(P,{gutter:[16,24]},{default:t(()=>[e(H,{span:4},{default:t(()=>[e(ie,{label:"字典编号",name:"code"},{default:t(()=>[e(K,{modelValue:f.value.code,"onUpdate:modelValue":o[0]||(o[0]=c=>f.value.code=c),clearable:"",placeholder:"请输入字典编号"},null,8,["modelValue"])]),_:1})]),_:1}),e(H,{span:4},{default:t(()=>[e(ie,{label:"字典名称",name:"dictValue"},{default:t(()=>[e(K,{modelValue:f.value.dictValue,"onUpdate:modelValue":o[1]||(o[1]=c=>f.value.dictValue=c),clearable:"",placeholder:"请输入字典名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(H,{span:2,class:"operation-wrapper"},{default:t(()=>[e(q,{theme:"primary",type:"submit",style:{marginLeft:"8px"}},{default:t(()=>o[8]||(o[8]=[y(" 查询 ")])),_:1}),e(q,{type:"reset",variant:"base",theme:"default"},{default:t(()=>o[9]||(o[9]=[y(" 重置 ")])),_:1})]),_:1})]),_:1})]),_:1},8,["data","onReset","onSubmit"]),te("div",$e,[e(ke,{ref_key:"enhancedTable",ref:l,data:g(b),columns:g(Ue),hover:!0,loading:g(_),tree:T,"selected-row-keys":a.value,"vertical-align":"top","row-key":"id",bordered:"",stripe:"",onSelectChange:F},{"top-content":t(()=>[e(P,{justify:"space-between",style:{"margin-bottom":"10px"}},{default:t(()=>[e(H,{flex:"0 0 auto"},{default:t(()=>[$((w(),A(q,{onClick:o[2]||(o[2]=c=>S({row:{}},"add"))},{default:t(()=>o[10]||(o[10]=[y("新增")])),_:1})),[[ue,"dict_add"]]),$((w(),A(q,{theme:"danger",onClick:W},{default:t(()=>o[11]||(o[11]=[y("删除")])),_:1})),[[ue,"dict_delete"]])]),_:1})]),_:1})]),source:t(({row:c})=>[e(ee,{name:c.source},null,8,["name"])]),isOpen:t(({row:c})=>[c.isOpen===0?(w(),A(pe,{key:0,theme:"warning",variant:"light"},{default:t(()=>o[12]||(o[12]=[y(" 否 ")])),_:1})):de("",!0),c.isOpen===1?(w(),A(pe,{key:1,theme:"success",variant:"light"},{default:t(()=>o[13]||(o[13]=[y(" 是 ")])),_:1})):de("",!0)]),op:t(c=>[te("a",{class:"t-button-link",onClick:ce=>S(c,"view")},"查看",8,Re),$((w(),J("a",{class:"t-button-link",onClick:ce=>S(c,"edit")},o[14]||(o[14]=[y("编辑")]),8,Ne)),[[ue,"dict_edit"]]),$((w(),J("a",{class:"t-button-link",onClick:ce=>j(c)},o[15]||(o[15]=[y("删除")]),8,je)),[[ue,"dict_delete"]]),g(R)(["administrator","admin"])?(w(),J("a",{key:0,class:"t-button-link",onClick:ce=>z(c)}," 新增子项 ",8,qe)):de("",!0)]),_:1},8,["data","columns","loading","tree","selected-row-keys"]),e(ve,{visible:C.value,"onUpdate:visible":o[3]||(o[3]=c=>C.value=c),header:"确认删除当前所选数据？","on-cancel":u,onConfirm:k},null,8,["visible"]),e(Ke,{visible:x.value,"onUpdate:visible":o[4]||(o[4]=c=>x.value=c),editId:U.value,"onUpdate:editId":o[5]||(o[5]=c=>U.value=c),actionType:d.value,"onUpdate:actionType":o[6]||(o[6]=c=>d.value=c),"row-data":h.value,onClosed:ne,onSubmit:oe},null,8,["visible","editId","actionType","row-data"])])]),_:1},8,["visible","header"])}}}),Le=re({__name:"DialogForm",props:{visible:{type:Boolean,default:!1},editId:{type:String,default:""},actionType:{type:String,default:""}},emits:["update:visible","update:editId","update:actionType","submit"],setup(L,{emit:O}){const R={code:"",dictValue:"",sort:void 0,isSealed:0,remark:""},m=L,h=s({code:[{required:!0,message:"请选择字典编号",type:"error",trigger:"blur"}],dictValue:[{required:!0,message:"请输入字典名称",type:"error",trigger:"blur"}],sort:[{required:!0,message:"请输入字典排序",type:"error",trigger:"blur"}],isSealed:[{required:!0,message:"请选择是否封存",type:"error",trigger:"change"}]}),M=le(()=>`${{view:"查看",edit:"编辑",add:"新增"}[m.actionType]||""}字典`),D=le(()=>({view:!0,edit:!1})[m.actionType]||!1),v=s(!1),a=s({...R}),T=s(null),V=s(!1),f=O,C=({firstError:d})=>{if(d)E.warning(d);else{V.value=!0;const l={...a.value,id:m.editId};_e(l).then(()=>{f("submit",l),E.success("提交成功"),v.value=!1}).finally(()=>{V.value=!1})}},x=()=>{a.value={...R},Z(()=>{f("update:editId",""),f("update:actionType","")})},U=()=>{v.value=!1};return Q(()=>v.value,d=>{f("update:visible",d)}),Q(()=>m.visible,d=>{d&&m.editId&&Z(()=>{fe(m.editId).then(l=>{a.value={...l}})}),Z(()=>{var l;(l=T.value)==null||l.clearValidate()}),v.value=d}),(d,l)=>{const I=n("t-input"),b=n("t-form-item"),_=n("t-col"),N=n("t-input-number"),S=n("t-switch"),z=n("t-textarea"),j=n("t-button"),B=n("t-row"),F=n("t-form"),G=n("t-dialog");return w(),A(G,{visible:v.value,"onUpdate:visible":l[5]||(l[5]=i=>v.value=i),header:M.value,width:780,footer:!1,onClosed:x},{body:t(()=>[e(F,{ref_key:"form",ref:T,class:me({"xy-form__detail":L.actionType==="view"}),data:a.value,rules:h.value,"label-width":100,disabled:D.value||V.value,onSubmit:C},{default:t(()=>[e(B,{gutter:[0,28]},{default:t(()=>[e(_,{span:12},{default:t(()=>[e(b,{label:"字典编号",name:"code"},{default:t(()=>[e(I,{modelValue:a.value.code,"onUpdate:modelValue":l[0]||(l[0]=i=>a.value.code=i),placeholder:"请输入字典编号",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(b,{label:"字典名称",name:"dictValue"},{default:t(()=>[e(I,{modelValue:a.value.dictValue,"onUpdate:modelValue":l[1]||(l[1]=i=>a.value.dictValue=i),placeholder:"请输入字典名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(b,{label:"字典排序",name:"sort"},{default:t(()=>[e(N,{modelValue:a.value.sort,"onUpdate:modelValue":l[2]||(l[2]=i=>a.value.sort=i),theme:"column",placeholder:"请输入字典排序",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(b,{label:"封存",name:"isSealed"},{default:t(()=>[e(S,{modelValue:a.value.isSealed,"onUpdate:modelValue":l[3]||(l[3]=i=>a.value.isSealed=i),"custom-value":[1,0]},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(b,{label:"字典备注",name:"remark"},{default:t(()=>[e(z,{modelValue:a.value.remark,"onUpdate:modelValue":l[4]||(l[4]=i=>a.value.remark=i),placeholder:"请输入字典备注",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),$(e(_,{span:12},{default:t(()=>[e(b,{style:{float:"right"}},{default:t(()=>[e(j,{variant:"outline",onClick:U},{default:t(()=>l[6]||(l[6]=[y("取消")])),_:1}),e(j,{theme:"primary",type:"submit"},{default:t(()=>l[7]||(l[7]=[y("确定")])),_:1})]),_:1})]),_:1},512),[[be,!D.value]])]),_:1})]),_:1},8,["class","data","rules","disabled"])]),_:1},8,["visible","header"])}}}),Be=[{colKey:"row-select",type:"multiple",width:64,fixed:"left"},{colKey:"serial-number",title:"序号",width:80,align:"center",fixed:"left"},{title:"字典编号",colKey:"code"},{title:"字典名称",colKey:"dictValue"},{title:"字典排序",colKey:"sort"},{title:"封存",colKey:"isSealed"},{fixed:"right",width:240,colKey:"op",title:"操作",align:"center"}],Fe={class:"table-wrapper"},Oe=["onClick"],Me=["onClick"],ze=["onClick"],We=["onClick"],Ye=re({__name:"dict",setup(L){const{tableVar:O}=Ie(),{getTableHeaderAffixedTop:R,getLayoutContainer:m}=xe(),{hasRole:h}=ge(),M={code:"",dictValue:""},D=s([]),v=s({...M}),a=s(!1),T=s(!1),V=s(""),f=s(""),C=s(!1),x=s({}),{fetchData:U,data:d,pagination:l,dataLoading:I}=we(Se,v.value,()=>{D.value=[]});he(()=>{U()});const b=({row:k},u)=>{V.value=k.id,f.value=u,T.value=!0},_=({row:k})=>{i.value=k.id,W.value="one",a.value=!0},N=({row:k})=>{x.value=k,C.value=!0},S=se(()=>{U()},300),z=k=>{D.value=k},j=k=>{l.value={...l.value,current:k.current||1,pageSize:k.pageSize},S()},F=se(async k=>{try{await Ve(k),a.value=!1,E.success("删除成功"),Y(),S()}catch{a.value=!1}},300),G=()=>{D.value.length&&(W.value="check",a.value=!0)},i=s(-1),W=s(),Y=()=>{i.value=-1,W.value=""},X=()=>{W.value==="check"&&F(D.value),W.value==="one"&&F([`${i.value}`])},ae=()=>{Y()};return(k,u)=>{const oe=n("t-input"),ne=n("t-form-item"),r=n("t-col"),o=n("t-row"),K=n("t-button"),ie=n("t-form"),H=n("t-table"),P=n("t-dialog"),q=ye("auth");return w(),J("div",{class:me(g(O))},[e(ie,{ref:"form",data:v.value,"label-width":80,colon:"",style:{marginBottom:"8px"},onReset:g(S),onSubmit:g(S)},{default:t(()=>[e(o,null,{default:t(()=>[e(r,{span:10},{default:t(()=>[e(o,{gutter:[16,24]},{default:t(()=>[e(r,{span:4},{default:t(()=>[e(ne,{label:"字典编号",name:"code"},{default:t(()=>[e(oe,{modelValue:v.value.code,"onUpdate:modelValue":u[0]||(u[0]=p=>v.value.code=p),clearable:"",placeholder:"请输入字典编号"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:4},{default:t(()=>[e(ne,{label:"字典名称",name:"dictValue"},{default:t(()=>[e(oe,{modelValue:v.value.dictValue,"onUpdate:modelValue":u[1]||(u[1]=p=>v.value.dictValue=p),clearable:"",placeholder:"请输入字典名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(r,{span:2,class:"operation-wrapper"},{default:t(()=>[e(K,{theme:"primary",type:"submit",style:{marginLeft:"8px"}},{default:t(()=>u[8]||(u[8]=[y(" 查询 ")])),_:1}),e(K,{type:"reset",variant:"base",theme:"default"},{default:t(()=>u[9]||(u[9]=[y(" 重置 ")])),_:1})]),_:1})]),_:1})]),_:1},8,["data","onReset","onSubmit"]),te("div",Fe,[e(H,{data:g(d),columns:g(Be),hover:!0,loading:g(I),pagination:g(l),"selected-row-keys":D.value,"header-affixed-top":{offsetTop:g(R),container:g(m)},"vertical-align":"top","row-key":"id",bordered:"",stripe:"",onPageChange:j,onSelectChange:z},{"top-content":t(()=>[e(o,{justify:"space-between",style:{"margin-bottom":"10px"}},{default:t(()=>[e(r,{flex:"0 0 auto"},{default:t(()=>[$((w(),A(K,{onClick:u[2]||(u[2]=p=>b({row:{}},"add"))},{default:t(()=>u[10]||(u[10]=[y("新增")])),_:1})),[[q,"dict_add"]]),$((w(),A(K,{theme:"danger",onClick:G},{default:t(()=>u[11]||(u[11]=[y("删除")])),_:1})),[[q,"dict_delete"]])]),_:1})]),_:1})]),isSealed:t(({row:p})=>[te("span",null,Te(p.isSealed?"是":"否"),1)]),op:t(p=>[te("a",{class:"t-button-link",onClick:ee=>b(p,"view")},"查看",8,Oe),$((w(),J("a",{class:"t-button-link",onClick:ee=>b(p,"edit")},u[12]||(u[12]=[y("编辑")]),8,Me)),[[q,"dict_edit"]]),$((w(),J("a",{class:"t-button-link",onClick:ee=>_(p)},u[13]||(u[13]=[y("删除")]),8,ze)),[[q,"dict_delete"]]),g(h)(["administrator","admin"])?(w(),J("a",{key:0,class:"t-button-link",onClick:ee=>N(p)}," 字典配置 ",8,We)):de("",!0)]),_:1},8,["data","columns","loading","pagination","selected-row-keys","header-affixed-top"]),e(P,{visible:a.value,"onUpdate:visible":u[3]||(u[3]=p=>a.value=p),header:"确认删除当前所选数据？","on-cancel":ae,onConfirm:X},null,8,["visible"]),e(Le,{visible:T.value,"onUpdate:visible":u[4]||(u[4]=p=>T.value=p),editId:V.value,"onUpdate:editId":u[5]||(u[5]=p=>V.value=p),actionType:f.value,"onUpdate:actionType":u[6]||(u[6]=p=>f.value=p),onSubmit:g(S)},null,8,["visible","editId","actionType","onSubmit"]),e(Ae,{visible:C.value,"onUpdate:visible":u[7]||(u[7]=p=>C.value=p),"row-data":x.value},null,8,["visible","row-data"])])],2)}}});export{Ye as default};
