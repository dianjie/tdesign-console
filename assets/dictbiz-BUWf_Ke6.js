import{an as ae,d as ce,f as d,J as le,a2 as X,Q as Z,r as n,o as k,m as L,w as t,a as e,s as pe,W as R,q as V,X as be,M as E,aw as _e,aq as he,as as ge,b as y,e as te,p as de,c as W,i as De,t as Se}from"./index-CqGaQ7t4.js";import{u as Te}from"./useSetting-CnYQd1RY.js";import{u as xe}from"./useDesign-CbWcZHFZ.js";import{u as ye}from"./useRequset-Bj5fiv5N.js";import{u as re}from"./index-BidCcHov.js";const Ie=(g,j,x)=>ae.get({url:"/blade-system/dict-biz/parent-list",params:{...x,current:g,size:j}},{joinTime:!1}),Ue=g=>ae.get({url:"/blade-system/dict-biz/child-list",params:g},{joinTime:!1}),Ve=g=>ae.get({url:"/blade-system/dict-biz/detail",params:{id:g}}),we=g=>ae.post({url:"/blade-system/dict-biz/remove",params:{ids:g}},{joinParamsToUrl:!0,errorMessageMode:"message"}),ke=g=>ae.post({url:"/blade-system/dict-biz/submit",data:g},{errorMessageMode:"message"}),Ke=[{colKey:"row-select",type:"multiple",width:64,fixed:"left"},{colKey:"serial-number",title:"序号",width:80,align:"center",fixed:"left"},{title:"字典编号",colKey:"code"},{title:"字典名称",colKey:"dictValue"},{title:"字典键值",colKey:"dictKey"},{title:"字典排序",colKey:"sort"},{title:"封存",colKey:"isSealed"},{fixed:"right",width:250,colKey:"op",title:"操作",align:"center"}],$e=ce({__name:"DialogForm",props:{visible:{type:Boolean,default:!1},editId:{type:String,default:""},actionType:{type:String,default:""},rowData:{type:Object,default:()=>({})}},emits:["update:visible","update:editId","update:actionType","submit","closed"],setup(g,{emit:j}){const x={code:"",parentId:"",parentName:"",dictValue:"",dictKey:"",sort:void 0,isSealed:0,remark:""},m=g,T=d({code:[{required:!0,message:"请选择字典编号",type:"error",trigger:"blur"}],dictValue:[{required:!0,message:"请输入字典名称",type:"error",trigger:"blur"}],dictKey:[{required:!0,message:"请输入字典键值",type:"error",trigger:"blur"}],sort:[{required:!0,message:"请输入字典排序",type:"error",trigger:"blur"}],isSealed:[{required:!0,message:"请选择是否封存",type:"error",trigger:"change"}]}),M=le(()=>`${{view:"查看",edit:"编辑",add:"新增"}[m.actionType]||""}字典`),D=le(()=>({view:!0,edit:!1})[m.actionType]||!1),v=d(!1),a=d({...x}),I=d(null),w=d(!1),f=j,h=({firstError:u})=>{if(u)E.warning(u);else{w.value=!0;const l={...a.value,id:m.editId};ke(l).then(()=>{f("submit",l),E.success("提交成功"),v.value=!1}).finally(()=>{w.value=!1})}},U=()=>{a.value={...x},Z(()=>{f("update:editId",""),f("update:actionType",""),f("closed")})},$=()=>{v.value=!1};return X(()=>v.value,u=>{f("update:visible",u)}),X(()=>m.visible,u=>{u&&m.editId&&Z(()=>{Ve(m.editId).then(l=>{a.value={...l}})}),Z(()=>{var l;(l=I.value)==null||l.clearValidate()}),v.value=u}),X(()=>m.rowData,u=>{a.value={...a.value,parentId:u.id,parentName:u.dictValue,code:u.code}}),(u,l)=>{const K=n("t-input"),b=n("t-form-item"),_=n("t-col"),N=n("t-input-number"),S=n("t-switch"),O=n("t-textarea"),q=n("t-button"),B=n("t-row"),F=n("t-form"),G=n("t-dialog");return k(),L(G,{visible:v.value,"onUpdate:visible":l[7]||(l[7]=i=>v.value=i),header:M.value,width:780,footer:!1,onClosed:U},{body:t(()=>[e(F,{ref_key:"form",ref:I,class:pe({"xy-form__detail":g.actionType==="view"}),data:a.value,rules:T.value,"label-width":100,disabled:D.value||w.value,onSubmit:h},{default:t(()=>[e(B,{gutter:[0,28]},{default:t(()=>[e(_,{span:12},{default:t(()=>[e(b,{label:"字典编号",name:"code"},{default:t(()=>[e(K,{modelValue:a.value.code,"onUpdate:modelValue":l[0]||(l[0]=i=>a.value.code=i),placeholder:"请输入字典编号",disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(b,{label:"上级字典",name:"parentName"},{default:t(()=>[e(K,{modelValue:a.value.parentName,"onUpdate:modelValue":l[1]||(l[1]=i=>a.value.parentName=i),placeholder:"请输入字典名称",disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(b,{label:"字典名称",name:"dictValue"},{default:t(()=>[e(K,{modelValue:a.value.dictValue,"onUpdate:modelValue":l[2]||(l[2]=i=>a.value.dictValue=i),placeholder:"请输入字典名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(b,{label:"字典键值",name:"dictKey"},{default:t(()=>[e(K,{modelValue:a.value.dictKey,"onUpdate:modelValue":l[3]||(l[3]=i=>a.value.dictKey=i),placeholder:"请输入字典键值",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(b,{label:"字典排序",name:"sort"},{default:t(()=>[e(N,{modelValue:a.value.sort,"onUpdate:modelValue":l[4]||(l[4]=i=>a.value.sort=i),theme:"column",placeholder:"请输入字典排序",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(b,{label:"封存",name:"isSealed"},{default:t(()=>[e(S,{modelValue:a.value.isSealed,"onUpdate:modelValue":l[5]||(l[5]=i=>a.value.isSealed=i),"custom-value":[1,0]},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(b,{label:"字典备注",name:"remark"},{default:t(()=>[e(O,{modelValue:a.value.remark,"onUpdate:modelValue":l[6]||(l[6]=i=>a.value.remark=i),placeholder:"请输入字典备注",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),R(e(_,{span:12},{default:t(()=>[e(b,{style:{float:"right"}},{default:t(()=>[e(q,{variant:"outline",onClick:$},{default:t(()=>l[8]||(l[8]=[V("取消")])),_:1}),e(q,{theme:"primary",type:"submit"},{default:t(()=>l[9]||(l[9]=[V("确定")])),_:1})]),_:1})]),_:1},512),[[be,!D.value]])]),_:1})]),_:1},8,["class","data","rules","disabled"])]),_:1},8,["visible","header"])}}}),ze={class:"table-wrapper"},Re=["onClick"],je=["onClick"],Ne=["onClick"],qe=["onClick"],Ae=ce({__name:"DialogList",props:{visible:{type:Boolean,default:!1},rowData:{type:Object,default:()=>({})}},emits:["update:visible"],setup(g,{emit:j}){const{hasRole:x}=_e(),m=g,T=d({}),M=j,D=le(()=>`[${m.rowData.dictValue}]字典配置`),v={code:"",dictValue:""},a=d([]),I=he({childrenKey:"children",treeNodeColumnIndex:2}),w=d(!1),f=d({...v}),h=d(!1),U=d(!1),$=d(""),u=d(""),l=d(null),{fetchData:K,data:b,dataLoading:_}=ye(Ue,{},()=>{a.value=[]},!1),N=()=>{K({...f.value,parentId:m.rowData.id})},S=({row:r},o)=>{$.value=r.id,u.value=o,U.value=!0},O=({row:r})=>{T.value=r,u.value="add",U.value=!0},q=({row:r})=>{Y.value=r.id,J.value="one",h.value=!0},B=re(()=>{N()},300),F=r=>{a.value=r},i=re(async r=>{try{await we(r),h.value=!1,E.success("删除成功"),oe(),B()}catch{h.value=!1}},300),H=()=>{a.value.length&&(J.value="check",h.value=!0)},Y=d(-1),J=d(),oe=()=>{Y.value=-1,J.value=""},C=()=>{J.value==="check"&&i(a.value),J.value==="one"&&i([`${Y.value}`])},s=()=>{oe()},ne=r=>{var z;const{parentId:o}=y(T.value);r.parentId!==o?N():r.id&&((z=l.value)==null||z.setData(r.id,{...T.value,...r}))},ie=()=>{T.value={...m.rowData}};return X(()=>w.value,r=>{M("update:visible",r)}),X(()=>m.visible,r=>{r&&m.rowData.id&&N(),w.value=r,T.value={...m.rowData}}),(r,o)=>{const z=n("t-input"),se=n("t-form-item"),Q=n("t-col"),P=n("t-row"),A=n("t-button"),p=n("t-form"),ee=n("t-icon"),ve=n("t-tag"),Ce=n("t-enhanced-table"),fe=n("t-dialog"),ue=ge("auth");return k(),L(fe,{visible:w.value,"onUpdate:visible":o[7]||(o[7]=c=>w.value=c),header:D.value,width:980,footer:!1},{default:t(()=>[e(p,{ref:"form",data:f.value,"label-width":80,colon:"",style:{marginBottom:"8px"},onReset:y(B),onSubmit:y(B)},{default:t(()=>[e(P,null,{default:t(()=>[e(Q,{span:10},{default:t(()=>[e(P,{gutter:[16,24]},{default:t(()=>[e(Q,{span:4},{default:t(()=>[e(se,{label:"字典编号",name:"code"},{default:t(()=>[e(z,{modelValue:f.value.code,"onUpdate:modelValue":o[0]||(o[0]=c=>f.value.code=c),clearable:"",placeholder:"请输入字典编号"},null,8,["modelValue"])]),_:1})]),_:1}),e(Q,{span:4},{default:t(()=>[e(se,{label:"字典名称",name:"dictValue"},{default:t(()=>[e(z,{modelValue:f.value.dictValue,"onUpdate:modelValue":o[1]||(o[1]=c=>f.value.dictValue=c),clearable:"",placeholder:"请输入字典名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Q,{span:2,class:"operation-wrapper"},{default:t(()=>[e(A,{theme:"primary",type:"submit",style:{marginLeft:"8px"}},{default:t(()=>o[8]||(o[8]=[V(" 查询 ")])),_:1}),e(A,{type:"reset",variant:"base",theme:"default"},{default:t(()=>o[9]||(o[9]=[V(" 重置 ")])),_:1})]),_:1})]),_:1})]),_:1},8,["data","onReset","onSubmit"]),te("div",ze,[e(Ce,{ref_key:"enhancedTable",ref:l,data:y(b),columns:y(Ke),hover:!0,loading:y(_),tree:I,"selected-row-keys":a.value,"vertical-align":"top","row-key":"id",bordered:"",stripe:"",onSelectChange:F},{"top-content":t(()=>[e(P,{justify:"space-between",style:{"margin-bottom":"10px"}},{default:t(()=>[e(Q,{flex:"0 0 auto"},{default:t(()=>[R((k(),L(A,{onClick:o[2]||(o[2]=c=>S({row:{}},"add"))},{default:t(()=>o[10]||(o[10]=[V("新增")])),_:1})),[[ue,"dictbiz_add"]]),R((k(),L(A,{theme:"danger",onClick:H},{default:t(()=>o[11]||(o[11]=[V("删除")])),_:1})),[[ue,"dictbiz_delete"]])]),_:1})]),_:1})]),source:t(({row:c})=>[e(ee,{name:c.source},null,8,["name"])]),isOpen:t(({row:c})=>[c.isOpen===0?(k(),L(ve,{key:0,theme:"warning",variant:"light"},{default:t(()=>o[12]||(o[12]=[V(" 否 ")])),_:1})):de("",!0),c.isOpen===1?(k(),L(ve,{key:1,theme:"success",variant:"light"},{default:t(()=>o[13]||(o[13]=[V(" 是 ")])),_:1})):de("",!0)]),op:t(c=>[te("a",{class:"t-button-link",onClick:me=>S(c,"view")},"查看",8,Re),R((k(),W("a",{class:"t-button-link",onClick:me=>S(c,"edit")},o[14]||(o[14]=[V("编辑")]),8,je)),[[ue,"dictbiz_edit"]]),R((k(),W("a",{class:"t-button-link",onClick:me=>q(c)},o[15]||(o[15]=[V("删除")]),8,Ne)),[[ue,"dictbiz_delete"]]),y(x)(["administrator","admin"])?(k(),W("a",{key:0,class:"t-button-link",onClick:me=>O(c)}," 新增子项 ",8,qe)):de("",!0)]),_:1},8,["data","columns","loading","tree","selected-row-keys"]),e(fe,{visible:h.value,"onUpdate:visible":o[3]||(o[3]=c=>h.value=c),header:"确认删除当前所选数据？","on-cancel":s,onConfirm:C},null,8,["visible"]),e($e,{visible:U.value,"onUpdate:visible":o[4]||(o[4]=c=>U.value=c),editId:$.value,"onUpdate:editId":o[5]||(o[5]=c=>$.value=c),actionType:u.value,"onUpdate:actionType":o[6]||(o[6]=c=>u.value=c),"row-data":T.value,onClosed:ie,onSubmit:ne},null,8,["visible","editId","actionType","row-data"])])]),_:1},8,["visible","header"])}}}),Le=ce({__name:"DialogForm",props:{visible:{type:Boolean,default:!1},editId:{type:String,default:""},actionType:{type:String,default:""}},emits:["update:visible","update:editId","update:actionType","submit"],setup(g,{emit:j}){const x={code:"",dictValue:"",sort:void 0,isSealed:0,remark:""},m=g,T=d({code:[{required:!0,message:"请选择字典编号",type:"error",trigger:"blur"}],dictValue:[{required:!0,message:"请输入字典名称",type:"error",trigger:"blur"}],sort:[{required:!0,message:"请输入字典排序",type:"error",trigger:"blur"}],isSealed:[{required:!0,message:"请选择是否封存",type:"error",trigger:"change"}]}),M=le(()=>`${{view:"查看",edit:"编辑",add:"新增"}[m.actionType]||""}字典`),D=le(()=>({view:!0,edit:!1})[m.actionType]||!1),v=d(!1),a=d({...x}),I=d(null),w=d(!1),f=j,h=({firstError:u})=>{if(u)E.warning(u);else{w.value=!0;const l={...a.value,id:m.editId};ke(l).then(()=>{f("submit",l),E.success("提交成功"),v.value=!1}).finally(()=>{w.value=!1})}},U=()=>{a.value={...x},Z(()=>{f("update:editId",""),f("update:actionType","")})},$=()=>{v.value=!1};return X(()=>v.value,u=>{f("update:visible",u)}),X(()=>m.visible,u=>{u&&m.editId&&Z(()=>{Ve(m.editId).then(l=>{a.value={...l}})}),Z(()=>{var l;(l=I.value)==null||l.clearValidate()}),v.value=u}),(u,l)=>{const K=n("t-input"),b=n("t-form-item"),_=n("t-col"),N=n("t-input-number"),S=n("t-switch"),O=n("t-textarea"),q=n("t-button"),B=n("t-row"),F=n("t-form"),G=n("t-dialog");return k(),L(G,{visible:v.value,"onUpdate:visible":l[5]||(l[5]=i=>v.value=i),header:M.value,width:780,footer:!1,onClosed:U},{body:t(()=>[e(F,{ref_key:"form",ref:I,class:pe({"xy-form__detail":g.actionType==="view"}),data:a.value,rules:T.value,"label-width":100,disabled:D.value||w.value,onSubmit:h},{default:t(()=>[e(B,{gutter:[0,28]},{default:t(()=>[e(_,{span:12},{default:t(()=>[e(b,{label:"字典编号",name:"code"},{default:t(()=>[e(K,{modelValue:a.value.code,"onUpdate:modelValue":l[0]||(l[0]=i=>a.value.code=i),placeholder:"请输入字典编号",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(b,{label:"字典名称",name:"dictValue"},{default:t(()=>[e(K,{modelValue:a.value.dictValue,"onUpdate:modelValue":l[1]||(l[1]=i=>a.value.dictValue=i),placeholder:"请输入字典名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(b,{label:"字典排序",name:"sort"},{default:t(()=>[e(N,{modelValue:a.value.sort,"onUpdate:modelValue":l[2]||(l[2]=i=>a.value.sort=i),theme:"column",placeholder:"请输入字典排序",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(b,{label:"封存",name:"isSealed"},{default:t(()=>[e(S,{modelValue:a.value.isSealed,"onUpdate:modelValue":l[3]||(l[3]=i=>a.value.isSealed=i),"custom-value":[1,0]},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(b,{label:"字典备注",name:"remark"},{default:t(()=>[e(O,{modelValue:a.value.remark,"onUpdate:modelValue":l[4]||(l[4]=i=>a.value.remark=i),placeholder:"请输入字典备注",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),R(e(_,{span:12},{default:t(()=>[e(b,{style:{float:"right"}},{default:t(()=>[e(q,{variant:"outline",onClick:$},{default:t(()=>l[6]||(l[6]=[V("取消")])),_:1}),e(q,{theme:"primary",type:"submit"},{default:t(()=>l[7]||(l[7]=[V("确定")])),_:1})]),_:1})]),_:1},512),[[be,!D.value]])]),_:1})]),_:1},8,["class","data","rules","disabled"])]),_:1},8,["visible","header"])}}}),Be=[{colKey:"row-select",type:"multiple",width:64,fixed:"left"},{colKey:"serial-number",title:"序号",width:80,align:"center",fixed:"left"},{title:"字典编号",colKey:"code"},{title:"字典名称",colKey:"dictValue"},{title:"字典排序",colKey:"sort"},{title:"封存",colKey:"isSealed"},{fixed:"right",width:240,colKey:"op",title:"操作",align:"center"}],Fe={class:"table-wrapper"},Me=["onClick"],Oe=["onClick"],He=["onClick"],Je=["onClick"],Ze=ce({__name:"dictbiz",setup(g){const{tableVar:j}=xe(),{getTableHeaderAffixedTop:x,getLayoutContainer:m}=Te(),{hasRole:T}=_e(),M={code:"",dictValue:""},D=d([]),v=d({...M}),a=d(!1),I=d(!1),w=d(""),f=d(""),h=d(!1),U=d({}),{fetchData:$,data:u,pagination:l,dataLoading:K}=ye(Ie,v.value,()=>{D.value=[]});De(()=>{$()});const b=({row:C},s)=>{w.value=C.id,f.value=s,I.value=!0},_=({row:C})=>{i.value=C.id,H.value="one",a.value=!0},N=({row:C})=>{U.value=C,h.value=!0},S=re(()=>{$()},300),O=C=>{D.value=C},q=C=>{l.value={...l.value,current:C.current||1,pageSize:C.pageSize},S()},F=re(async C=>{try{await we(C),a.value=!1,E.success("删除成功"),Y(),S()}catch{a.value=!1}},300),G=()=>{D.value.length&&(H.value="check",a.value=!0)},i=d(-1),H=d(),Y=()=>{i.value=-1,H.value=""},J=()=>{H.value==="check"&&F(D.value),H.value==="one"&&F([`${i.value}`])},oe=()=>{Y()};return(C,s)=>{const ne=n("t-input"),ie=n("t-form-item"),r=n("t-col"),o=n("t-row"),z=n("t-button"),se=n("t-form"),Q=n("t-table"),P=n("t-dialog"),A=ge("auth");return k(),W("div",{class:pe(y(j))},[e(se,{ref:"form",data:v.value,"label-width":80,colon:"",style:{marginBottom:"8px"},onReset:y(S),onSubmit:y(S)},{default:t(()=>[e(o,null,{default:t(()=>[e(r,{span:10},{default:t(()=>[e(o,{gutter:[16,24]},{default:t(()=>[e(r,{span:4},{default:t(()=>[e(ie,{label:"字典编号",name:"code"},{default:t(()=>[e(ne,{modelValue:v.value.code,"onUpdate:modelValue":s[0]||(s[0]=p=>v.value.code=p),clearable:"",placeholder:"请输入字典编号"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:4},{default:t(()=>[e(ie,{label:"字典名称",name:"dictValue"},{default:t(()=>[e(ne,{modelValue:v.value.dictValue,"onUpdate:modelValue":s[1]||(s[1]=p=>v.value.dictValue=p),clearable:"",placeholder:"请输入字典名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(r,{span:2,class:"operation-wrapper"},{default:t(()=>[e(z,{theme:"primary",type:"submit",style:{marginLeft:"8px"}},{default:t(()=>s[8]||(s[8]=[V(" 查询 ")])),_:1}),e(z,{type:"reset",variant:"base",theme:"default"},{default:t(()=>s[9]||(s[9]=[V(" 重置 ")])),_:1})]),_:1})]),_:1})]),_:1},8,["data","onReset","onSubmit"]),te("div",Fe,[e(Q,{data:y(u),columns:y(Be),hover:!0,loading:y(K),pagination:y(l),"selected-row-keys":D.value,"header-affixed-top":{offsetTop:y(x),container:y(m)},"vertical-align":"top","row-key":"id",bordered:"",stripe:"",onPageChange:q,onSelectChange:O},{"top-content":t(()=>[e(o,{justify:"space-between",style:{"margin-bottom":"10px"}},{default:t(()=>[e(r,{flex:"0 0 auto"},{default:t(()=>[R((k(),L(z,{onClick:s[2]||(s[2]=p=>b({row:{}},"add"))},{default:t(()=>s[10]||(s[10]=[V("新增")])),_:1})),[[A,"dictbiz_add"]]),R((k(),L(z,{theme:"danger",onClick:G},{default:t(()=>s[11]||(s[11]=[V("删除")])),_:1})),[[A,"dictbiz_delete"]])]),_:1})]),_:1})]),isSealed:t(({row:p})=>[te("span",null,Se(p.isSealed?"是":"否"),1)]),op:t(p=>[te("a",{class:"t-button-link",onClick:ee=>b(p,"view")},"查看",8,Me),R((k(),W("a",{class:"t-button-link",onClick:ee=>b(p,"edit")},s[12]||(s[12]=[V("编辑")]),8,Oe)),[[A,"dictbiz_edit"]]),R((k(),W("a",{class:"t-button-link",onClick:ee=>_(p)},s[13]||(s[13]=[V("删除")]),8,He)),[[A,"dictbiz_delete"]]),y(T)(["administrator","admin"])?(k(),W("a",{key:0,class:"t-button-link",onClick:ee=>N(p)}," 字典配置 ",8,Je)):de("",!0)]),_:1},8,["data","columns","loading","pagination","selected-row-keys","header-affixed-top"]),e(P,{visible:a.value,"onUpdate:visible":s[3]||(s[3]=p=>a.value=p),header:"确认删除当前所选数据？","on-cancel":oe,onConfirm:J},null,8,["visible"]),e(Le,{visible:I.value,"onUpdate:visible":s[4]||(s[4]=p=>I.value=p),editId:w.value,"onUpdate:editId":s[5]||(s[5]=p=>w.value=p),actionType:f.value,"onUpdate:actionType":s[6]||(s[6]=p=>f.value=p),onSubmit:y(S)},null,8,["visible","editId","actionType","onSubmit"]),e(Ae,{visible:h.value,"onUpdate:visible":s[7]||(s[7]=p=>h.value=p),"row-data":U.value},null,8,["visible","row-data"])])],2)}}});export{Ze as default};
