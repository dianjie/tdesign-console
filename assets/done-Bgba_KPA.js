import{d as A,aG as E,f as m,i as G,l as H,r as s,aw as P,o as f,c as _,a as e,w as t,b as a,q as r,e as j,$ as V,t as J,s as Q,ax as W}from"./index-OjS_2jsV.js";import{d as X}from"./work-Z6eVb-uy.js";import{_ as Y}from"./index.vue_vue_type_script_setup_true_lang-D9tncBwu.js";import{u as Z}from"./useSetting-BlFh-p_q.js";import{u as ee}from"./useDesign-CbWcZHFZ.js";import{u as te}from"./useRequset-BqiZ8nsq.js";import{g as oe,f as ae}from"./flowHelper-BQUcMvxs.js";import{u as ne}from"./index-BiO29gyn.js";import"./flow-fOLvsXZF.js";const se=[{colKey:"serial-number",title:"序号",width:80,align:"center",fixed:"left"},{title:"流程分类",colKey:"categoryName"},{title:"流程名称",colKey:"processDefinitionName"},{title:"当前步骤",colKey:"taskName"},{title:"流程版本",colKey:"processDefinitionVersion"},{title:"申请时间",colKey:"createTime"},{fixed:"right",width:180,colKey:"op",title:"操作",align:"center"}],le={class:"table-wrapper"},ie=["onClick"],re=["onClick"],ye=A({__name:"done",setup(ce){const{tableVar:k}=ee(),{getTableHeaderAffixedTop:C,getLayoutContainer:x}=Z(),N={category:"",processDefinitionName:""},g=E(),l=m({...N}),S=g.getFlowDict,{fetchData:F,data:K,pagination:u,dataLoading:R}=te(X,l.value,W),v=()=>{F({...l.value,category:oe(l.value.category)})};G(()=>{v()});const d=ne(()=>{v()},300),$=n=>{u.value={...u.value,current:n.current||1,pageSize:n.pageSize},d()},p=m(!1),b=m({}),L=({row:n})=>{b.value=n,p.value=!0},T=H(),B=({row:n})=>{T.push({path:`/work/process/${ae(g.getFlowRoutes,n.category)}/detail/${n.processInstanceId}/${n.businessId}`})};return(n,i)=>{const I=s("t-select"),y=s("t-form-item"),c=s("t-col"),U=s("t-input"),h=s("t-row"),w=s("t-button"),z=s("t-form"),q=s("t-tag"),M=s("t-table"),D=P("auth");return f(),_("div",{class:Q(a(k))},[e(z,{ref:"form",data:l.value,"label-width":80,colon:"",style:{marginBottom:"8px"},onReset:a(d),onSubmit:a(d)},{default:t(()=>[e(h,null,{default:t(()=>[e(c,{span:10},{default:t(()=>[e(h,{gutter:[16,24]},{default:t(()=>[e(c,{span:4},{default:t(()=>[e(y,{label:"流程分类",name:"category"},{default:t(()=>[e(I,{modelValue:l.value.category,"onUpdate:modelValue":i[0]||(i[0]=o=>l.value.category=o),options:a(S),keys:{value:"dictKey",label:"dictValue"},clearable:"",placeholder:"请选择流程分类"},null,8,["modelValue","options"])]),_:1})]),_:1}),e(c,{span:4},{default:t(()=>[e(y,{label:"流程名称",name:"processDefinitionName"},{default:t(()=>[e(U,{modelValue:l.value.processDefinitionName,"onUpdate:modelValue":i[1]||(i[1]=o=>l.value.processDefinitionName=o),clearable:"",placeholder:"请输入流程名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(c,{span:2,class:"operation-wrapper"},{default:t(()=>[e(w,{theme:"primary",type:"submit",style:{marginLeft:"8px"}},{default:t(()=>[r(" 查询 ")]),_:1}),e(w,{type:"reset",variant:"base",theme:"default"},{default:t(()=>[r(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["data","onReset","onSubmit"]),j("div",le,[e(M,{data:a(K),columns:a(se),hover:!0,loading:a(R),pagination:a(u),"header-affixed-top":{offsetTop:a(C),container:a(x)},"vertical-align":"top","row-key":"id",bordered:"",stripe:"",onPageChange:$},{op:t(o=>[V((f(),_("a",{class:"t-button-link",onClick:O=>B(o)},[r("详情")],8,ie)),[[D,"work_done_detail"]]),V((f(),_("a",{class:"t-button-link",onClick:O=>L(o)},[r("流程图")],8,re)),[[D,"work_done_follow"]])]),processDefinitionVersion:t(({row:o})=>[e(q,{theme:"primary",variant:"light"},{default:t(()=>[r("v"+J(o.processDefinitionVersion),1)]),_:2},1024)]),_:1},8,["data","columns","loading","pagination","header-affixed-top"]),e(Y,{visible:p.value,"onUpdate:visible":i[2]||(i[2]=o=>p.value=o),"row-data":b.value,type:"diagram"},null,8,["visible","row-data"])])],2)}}});export{ye as default};
