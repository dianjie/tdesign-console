import{f as N,a as z}from"./flow-DzSZmebQ.js";import{u as q}from"./useSetting-CnYQd1RY.js";import{u as A}from"./useDesign-CbWcZHFZ.js";import{u as E}from"./useRequset-Bj5fiv5N.js";import{d as H,f as m,i as O,r as n,as as W,o as w,c as D,a as e,w as t,q as f,b as l,e as $,W as j,t as G,s as J,ab as Q,M as X,at as Y}from"./index-CqGaQ7t4.js";import{u as V}from"./index-BidCcHov.js";const Z=[{colKey:"serial-number",title:"序号",width:80,align:"center",fixed:"left"},{title:"执行id",colKey:"executionId"},{title:"流程key",colKey:"processDefinitionKey"},{title:"实例id",colKey:"processInstanceId"},{title:"状态",colKey:"suspensionState"},{title:"发起人",colKey:"startUser"},{title:"开始时间",colKey:"startTime"},{fixed:"right",width:100,colKey:"op",title:"操作",align:"center"}],ee={class:"table-wrapper"},te=["onClick"],ce=H({__name:"follow",setup(oe){const{tableVar:x}=A(),{getTableHeaderAffixedTop:h,getLayoutContainer:C}=q(),s=m({...{executionId:"",processDefinitionKey:"",processInstanceId:""}}),d=m(!1),{fetchData:g,data:K,pagination:_,dataLoading:k}=E(N,s.value,Y);O(()=>{g()});const u=V(()=>{g()},300),S=i=>{_.value={..._.value,current:i.current||1,pageSize:i.pageSize},u()},v=m(""),c=m(""),U=({row:i})=>{v.value=i.processInstanceId,d.value=!0},L=()=>{const i=Q.confirm({header:"提示",theme:"warning",body:"确定将选择数据删除?",onConfirm:V(async()=>{await z({deleteReason:c.value,processInstanceId:v.value}),d.value=!1,X.success("删除成功"),i.destroy(),u()},300)})},P=()=>{c.value="",v.value=""};return(i,o)=>{const p=n("t-input"),b=n("t-form-item"),r=n("t-col"),y=n("t-row"),I=n("t-button"),R=n("t-form"),T=n("t-tag"),B=n("t-table"),F=n("t-dialog"),M=W("auth");return w(),D("div",{class:J(l(x))},[e(R,{ref:"form",data:s.value,"label-width":80,colon:"",style:{marginBottom:"8px"},onReset:l(u),onSubmit:l(u)},{default:t(()=>[e(y,null,{default:t(()=>[e(r,{span:10},{default:t(()=>[e(y,{gutter:[16,24]},{default:t(()=>[e(r,{span:4},{default:t(()=>[e(b,{label:"执行id",name:"executionId"},{default:t(()=>[e(p,{modelValue:s.value.executionId,"onUpdate:modelValue":o[0]||(o[0]=a=>s.value.executionId=a),clearable:"",placeholder:"请输入执行id"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:4},{default:t(()=>[e(b,{label:"流程key",name:"processDefinitionKey"},{default:t(()=>[e(p,{modelValue:s.value.processDefinitionKey,"onUpdate:modelValue":o[1]||(o[1]=a=>s.value.processDefinitionKey=a),clearable:"",placeholder:"请输入流程key"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:4},{default:t(()=>[e(b,{label:"实例id",name:"processInstanceId"},{default:t(()=>[e(p,{modelValue:s.value.processInstanceId,"onUpdate:modelValue":o[2]||(o[2]=a=>s.value.processInstanceId=a),clearable:"",placeholder:"请输入实例id"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(r,{span:2,class:"operation-wrapper"},{default:t(()=>[e(I,{theme:"primary",type:"submit",style:{marginLeft:"8px"}},{default:t(()=>o[5]||(o[5]=[f(" 查询 ")])),_:1}),e(I,{type:"reset",variant:"base",theme:"default"},{default:t(()=>o[6]||(o[6]=[f(" 重置 ")])),_:1})]),_:1})]),_:1})]),_:1},8,["data","onReset","onSubmit"]),$("div",ee,[e(B,{data:l(K),columns:l(Z),hover:!0,loading:l(k),pagination:l(_),"header-affixed-top":{offsetTop:l(h),container:l(C)},"vertical-align":"top","row-key":"id",bordered:"",stripe:"",onPageChange:S},{op:t(a=>[j((w(),D("a",{class:"t-button-link",onClick:ne=>U(a)},o[7]||(o[7]=[f("删除")]),8,te)),[[M,"flow_follow_delete"]])]),suspensionState:t(({row:a})=>[e(T,null,{default:t(()=>[f(G(a.suspensionState===1?"激活":"挂起"),1)]),_:2},1024)]),_:1},8,["data","columns","loading","pagination","header-affixed-top"]),e(F,{visible:d.value,"onUpdate:visible":o[4]||(o[4]=a=>d.value=a),header:"流程删除",onConfirm:L,onClosed:P},{body:t(()=>[e(p,{modelValue:c.value,"onUpdate:modelValue":o[3]||(o[3]=a=>c.value=a),label:"删除原因：",placeholder:"请输入删除原因",clearable:""},null,8,["modelValue"])]),_:1},8,["visible"])])],2)}}});export{ce as default};
