import{f as N,a as z}from"./flow-3be5ae94.js";import{u as q}from"./useSetting-9ed5cec4.js";import{u as $}from"./useDesign-16212514.js";import{u as A}from"./useRequset-d7ecab22.js";import{d as E,f as m,i as H,r as n,aw as O,o as h,c as w,a as e,w as t,q as f,b as l,e as j,$ as G,t as J,s as Q,ag as W,M as X,ax as Y}from"./index-c2e89b2e.js";import{u as x}from"./index-d5763e7f.js";const Z=[{colKey:"serial-number",title:"序号",width:80,align:"center",fixed:"left"},{title:"执行id",colKey:"executionId"},{title:"流程key",colKey:"processDefinitionKey"},{title:"实例id",colKey:"processInstanceId"},{title:"状态",colKey:"suspensionState"},{title:"发起人",colKey:"startUser"},{title:"开始时间",colKey:"startTime"},{fixed:"right",width:100,colKey:"op",title:"操作",align:"center"}],ee={class:"table-wrapper"},te=["onClick"],ue=E({__name:"follow",setup(ae){const{tableVar:D}=$(),{getTableHeaderAffixedTop:V,getLayoutContainer:C}=q(),s=m({...{executionId:"",processDefinitionKey:"",processInstanceId:""}}),d=m(!1),{fetchData:b,data:K,pagination:_,dataLoading:k}=A(N,s.value,Y);H(()=>{b()});const c=x(()=>{b()},300),S=i=>{_.value={..._.value,current:i.current||1,pageSize:i.pageSize},c()},v=m(""),u=m(""),U=({row:i})=>{v.value=i.processInstanceId,d.value=!0},L=()=>{const i=W.confirm({header:"提示",theme:"warning",body:"确定将选择数据删除?",onConfirm:x(async()=>{await z({deleteReason:u.value,processInstanceId:v.value}),d.value=!1,X.success("删除成功"),i.destroy(),c()},300)})},P=()=>{u.value="",v.value=""};return(i,o)=>{const p=n("t-input"),g=n("t-form-item"),r=n("t-col"),y=n("t-row"),I=n("t-button"),R=n("t-form"),T=n("t-tag"),B=n("t-table"),F=n("t-dialog"),M=O("auth");return h(),w("div",{class:Q(l(D))},[e(R,{ref:"form",data:s.value,"label-width":80,colon:"",style:{marginBottom:"8px"},onReset:l(c),onSubmit:l(c)},{default:t(()=>[e(y,null,{default:t(()=>[e(r,{span:10},{default:t(()=>[e(y,{gutter:[16,24]},{default:t(()=>[e(r,{span:4},{default:t(()=>[e(g,{label:"执行id",name:"executionId"},{default:t(()=>[e(p,{modelValue:s.value.executionId,"onUpdate:modelValue":o[0]||(o[0]=a=>s.value.executionId=a),clearable:"",placeholder:"请输入执行id"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:4},{default:t(()=>[e(g,{label:"流程key",name:"processDefinitionKey"},{default:t(()=>[e(p,{modelValue:s.value.processDefinitionKey,"onUpdate:modelValue":o[1]||(o[1]=a=>s.value.processDefinitionKey=a),clearable:"",placeholder:"请输入流程key"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:4},{default:t(()=>[e(g,{label:"实例id",name:"processInstanceId"},{default:t(()=>[e(p,{modelValue:s.value.processInstanceId,"onUpdate:modelValue":o[2]||(o[2]=a=>s.value.processInstanceId=a),clearable:"",placeholder:"请输入实例id"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(r,{span:2,class:"operation-wrapper"},{default:t(()=>[e(I,{theme:"primary",type:"submit",style:{marginLeft:"8px"}},{default:t(()=>[f(" 查询 ")]),_:1}),e(I,{type:"reset",variant:"base",theme:"default"},{default:t(()=>[f(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["data","onReset","onSubmit"]),j("div",ee,[e(B,{data:l(K),columns:l(Z),hover:!0,loading:l(k),pagination:l(_),"header-affixed-top":{offsetTop:l(V),container:l(C)},"vertical-align":"top","row-key":"id",bordered:"",stripe:"",onPageChange:S},{op:t(a=>[G((h(),w("a",{class:"t-button-link",onClick:ne=>U(a)},[f("删除")],8,te)),[[M,"flow_follow_delete"]])]),suspensionState:t(({row:a})=>[e(T,null,{default:t(()=>[f(J(a.suspensionState===1?"激活":"挂起"),1)]),_:2},1024)]),_:1},8,["data","columns","loading","pagination","header-affixed-top"]),e(F,{visible:d.value,"onUpdate:visible":o[4]||(o[4]=a=>d.value=a),header:"流程删除",onConfirm:L,onClosed:P},{body:t(()=>[e(p,{modelValue:u.value,"onUpdate:modelValue":o[3]||(o[3]=a=>u.value=a),label:"删除原因：",placeholder:"请输入删除原因",clearable:""},null,8,["modelValue"])]),_:1},8,["visible"])])],2)}}});export{ue as default};
