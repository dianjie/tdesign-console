import{d as _}from"./dayjs.min-Err39j0x.js";import{d as q,f as d,P as S,ad as B,ai as N,r as s,o as A,c as L,e as M,a as e,w as a,b as m,q as P,s as j,L as z,l as F,M as g}from"./index-CqGaQ7t4.js";import{l as O}from"./leave-Cm3ggJQt.js";import{u as E}from"./useDesign-CbWcZHFZ.js";import{u as v}from"./index-BidCcHov.js";const X=q({__name:"form",setup(G){const{tableVar:V}=E(),T={taskUser:"",startTime:"",endTime:"",reason:""},k=d({taskUser:[{required:!0,message:"请选择审批人员",type:"error",trigger:"change"}],startTime:[{required:!0,message:"请选择开始时间",type:"error",trigger:"change"}],endTime:[{required:!0,message:"请选择结束时间",type:"error",trigger:"change"}],reason:[{required:!0,message:"请输入请假理由",type:"error",trigger:"blur"}]}),o=d({...T}),c=d([]),i=d(!1),p=z(),y=F(),f=S(),{tabRouters:w}=f;B(()=>{N().then(l=>{c.value=l})});const h=v(()=>{const l=w.findIndex(t=>t.path===p.path);f.subtractCurrentTabRouter({path:p.path,routeIdx:l}),y.replace({path:"/work/start"})},300),U=v(({firstError:l})=>{if(l)g.warning(l);else{i.value=!0;const t={processDefinitionId:p.params.processDefinitionId,...o.value};O(t).then(()=>{g.success("提交成功"),h()}).finally(()=>{i.value=!1})}},300);return(l,t)=>{const x=s("t-select"),n=s("t-form-item"),u=s("t-col"),b=s("t-date-picker"),D=s("t-textarea"),I=s("t-button"),C=s("t-row"),R=s("t-form");return A(),L("div",{class:j(m(V))},[t[5]||(t[5]=M("p",{class:"form__title"},"发起请假",-1)),e(R,{ref:"form",data:o.value,"label-width":80,disabled:i.value,rules:k.value,onSubmit:m(U)},{default:a(()=>[e(C,{gutter:[0,28]},{default:a(()=>[e(u,{span:12},{default:a(()=>[e(n,{label:"审批人员",name:"taskUser"},{default:a(()=>[e(x,{modelValue:o.value.taskUser,"onUpdate:modelValue":t[0]||(t[0]=r=>o.value.taskUser=r),options:c.value,keys:{value:"id",label:"account"},clearable:"",placeholder:"请选择审批人员"},null,8,["modelValue","options"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(n,{label:"开始时间",name:"startTime"},{default:a(()=>[e(b,{modelValue:o.value.startTime,"onUpdate:modelValue":t[1]||(t[1]=r=>o.value.startTime=r),"disable-date":{before:m(_)().subtract(1,"day").format()},"enable-time-picker":"","allow-input":"",clearable:"",placeholder:"请选择开始时间",style:{width:"100%"}},null,8,["modelValue","disable-date"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(n,{label:"结束时间",name:"endTime"},{default:a(()=>[e(b,{modelValue:o.value.endTime,"onUpdate:modelValue":t[2]||(t[2]=r=>o.value.endTime=r),"disable-date":{before:m(_)().subtract(1,"day").format()},"enable-time-picker":"","allow-input":"",clearable:"",placeholder:"请选择结束时间",style:{width:"100%"}},null,8,["modelValue","disable-date"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(n,{label:"请假理由",name:"reason"},{default:a(()=>[e(D,{modelValue:o.value.reason,"onUpdate:modelValue":t[3]||(t[3]=r=>o.value.reason=r),placeholder:"请输入请假理由"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(n,null,{default:a(()=>[e(I,{theme:"primary",type:"submit"},{default:a(()=>t[4]||(t[4]=[P("提交")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["data","disabled","rules","onSubmit"])],2)}}});export{X as default};
