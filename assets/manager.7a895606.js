import{d as oe,r as s,aQ as ue,a as le,e as l,aG as ne,f as _,i as v,l as e,w as t,j as n,p as i,n as se,J as A,t as k,q as ie,V as re,M as L,aH as de,_ as ce}from"./index.8ed3877a.js";import{u as me}from"./useDesign.9d0ca2bc.js";import{u as pe}from"./useSetting.01b849d1.js";import{u as fe}from"./useRequset.50973ce5.js";import{g as _e}from"./flowHelper.b40b68ad.js";import{m as ve,b as ge,c as ye}from"./flow.efe49ab3.js";import{F as be}from"./index.17cfff5a.js";import{u as N}from"./index.74383c1c.js";const De=[{colKey:"serial-number",title:"\u5E8F\u53F7",width:80,align:"center",fixed:"left"},{title:"\u79DF\u6237\u7F16\u53F7",colKey:"tenantId"},{title:"\u6D41\u7A0B\u4E3B\u952E",colKey:"id"},{title:"\u6D41\u7A0B\u6807\u8BC6",colKey:"key"},{title:"\u6D41\u7A0B\u540D\u79F0",colKey:"name"},{title:"\u6D41\u7A0B\u5206\u7C7B",colKey:"categoryName"},{title:"\u6D41\u7A0B\u7248\u672C",colKey:"version"},{title:"\u72B6\u6001",colKey:"suspensionState"},{title:"\u90E8\u7F72\u65F6\u95F4",colKey:"deploymentTime"},{fixed:"right",width:210,colKey:"op",title:"\u64CD\u4F5C",align:"center"}],Be={class:"table-wrapper"},he=["onClick"],Fe=["onClick"],Ce=["onClick"],we=oe({__name:"manager",setup(Ae){const{tableVar:M}=me(),{getTableHeaderAffixedTop:R,getLayoutContainer:q}=pe(),r=s({...{key:"",category:""}}),p=s(!1),z=ue().getFlowDict,g=s("1"),{fetchData:O,data:P,pagination:y,dataLoading:$}=fe(ve,r.value,de),V=()=>{O({...r.value,category:_e(r.value.category),mode:g.value})};le(()=>{V()});const d=N(()=>{V()},300),j=u=>{y.value={...y.value,current:u.current||1,pageSize:u.pageSize},d()},H=({row:u})=>{const o=re.confirm({header:"\u63D0\u793A",theme:"warning",body:"\u786E\u8BA4\u5220\u9664\u5F53\u524D\u6240\u9009\u6570\u636E?",onConfirm:N(async()=>{await ge(u.deploymentId),L.success("\u5220\u9664\u6210\u529F"),o.destroy(),d()},300)})},G={type:""},J=s({type:[{required:!0,message:"\u8BF7\u9009\u62E9\u6D41\u7A0B\u72B6\u6001",type:"error",trigger:"change"}]}),Q=[{value:"active",label:"\u6FC0\u6D3B"},{value:"suspend",label:"\u6302\u8D77"}],c=s(!1),f=s({...G}),b=s(null),D=s(""),W=()=>{var u;(u=b.value)==null||u.validate({fields:["type"]}).then(async o=>{if(o===!0){c.value=!0;try{await ye({processId:D.value,state:f.value.type}),p.value=!1,c.value=!1,L.success("\u53D8\u66F4\u6210\u529F"),d()}catch{c.value=!1}}})},X=()=>{var u;(u=b.value)==null||u.reset(),D.value=""},Y=({row:u})=>{D.value=u.id,p.value=!0},B=s(!1),x=s({}),Z=({row:u})=>{x.value=u,B.value=!0};return(u,o)=>{const E=l("t-input"),h=l("t-form-item"),m=l("t-col"),S=l("t-select"),F=l("t-row"),I=l("t-button"),K=l("t-form"),T=l("t-radio-button"),ee=l("t-radio-group"),C=l("t-tag"),te=l("t-table"),ae=l("t-dialog"),w=ne("auth");return _(),v("div",{class:ie(n(M))},[e(K,{ref:"form",data:r.value,"label-width":80,colon:"",style:{marginBottom:"8px"},onReset:n(d),onSubmit:n(d)},{default:t(()=>[e(F,null,{default:t(()=>[e(m,{span:10},{default:t(()=>[e(F,{gutter:[16,24]},{default:t(()=>[e(m,{span:4},{default:t(()=>[e(h,{label:"\u6D41\u7A0B\u6807\u8BC6",name:"key"},{default:t(()=>[e(E,{modelValue:r.value.key,"onUpdate:modelValue":o[0]||(o[0]=a=>r.value.key=a),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u6D41\u7A0B\u6807\u8BC6"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{span:4},{default:t(()=>[e(h,{label:"\u6D41\u7A0B\u5206\u7C7B",name:"category"},{default:t(()=>[e(S,{modelValue:r.value.category,"onUpdate:modelValue":o[1]||(o[1]=a=>r.value.category=a),options:n(z),keys:{value:"dictKey",label:"dictValue"},clearable:"",placeholder:"\u8BF7\u9009\u62E9\u6D41\u7A0B\u5206\u7C7B"},null,8,["modelValue","options"])]),_:1})]),_:1})]),_:1})]),_:1}),e(m,{span:2,class:"operation-wrapper"},{default:t(()=>[e(I,{theme:"primary",type:"submit",style:{marginLeft:"8px"}},{default:t(()=>[i(" \u67E5\u8BE2 ")]),_:1}),e(I,{type:"reset",variant:"base",theme:"default"},{default:t(()=>[i(" \u91CD\u7F6E ")]),_:1})]),_:1})]),_:1})]),_:1},8,["data","onReset","onSubmit"]),se("div",Be,[e(te,{data:n(P),columns:n(De),hover:!0,loading:n($),pagination:n(y),"header-affixed-top":{offsetTop:n(R),container:n(q)},"vertical-align":"top","row-key":"id",bordered:"",stripe:"",onPageChange:j},{"top-content":t(()=>[e(F,{justify:"space-between",style:{"margin-bottom":"10px"}},{default:t(()=>[e(m,{flex:"0 0 auto"},{default:t(()=>[e(ee,{modelValue:g.value,"onUpdate:modelValue":o[2]||(o[2]=a=>g.value=a),onChange:n(d)},{default:t(()=>[e(T,{value:"1"},{default:t(()=>[i("\u901A\u7528\u6D41\u7A0B")]),_:1}),e(T,{value:"2"},{default:t(()=>[i("\u5B9A\u5236\u6D41\u7A0B")]),_:1})]),_:1},8,["modelValue","onChange"])]),_:1})]),_:1})]),op:t(a=>[A((_(),v("a",{class:"t-button-link",onClick:U=>Y(a)},[i("\u53D8\u66F4\u72B6\u6001")],8,he)),[[w,"flow_manager_state"]]),A((_(),v("a",{class:"t-button-link",onClick:U=>Z(a)},[i("\u6D41\u7A0B\u56FE")],8,Fe)),[[w,"flow_manager_image"]]),A((_(),v("a",{class:"t-button-link",onClick:U=>H(a)},[i("\u5220\u9664")],8,Ce)),[[w,"flow_manager_remove"]])]),tenantId:t(({row:a})=>[e(C,{theme:"primary",variant:"light"},{default:t(()=>[i(k(a.tenantId?a.tenantId:"\u901A\u7528"),1)]),_:2},1024)]),version:t(({row:a})=>[e(C,{theme:"primary",variant:"light"},{default:t(()=>[i("v"+k(a.version),1)]),_:2},1024)]),suspensionState:t(({row:a})=>[e(C,{theme:"primary",variant:"light"},{default:t(()=>[i(k(a.suspensionState===1?"\u6FC0\u6D3B":"\u6302\u8D77"),1)]),_:2},1024)]),_:1},8,["data","columns","loading","pagination","header-affixed-top"]),e(ae,{visible:p.value,"onUpdate:visible":o[4]||(o[4]=a=>p.value=a),header:"\u6D41\u7A0B\u53D8\u66F4","confirm-btn":{loading:c.value},onConfirm:W,onClosed:X},{body:t(()=>[e(K,{ref_key:"form2",ref:b,data:f.value,rules:J.value,"label-width":100,disabled:c.value,style:{padding:"25px 0"}},{default:t(()=>[e(h,{label:"\u6D41\u7A0B\u72B6\u6001",name:"type"},{default:t(()=>[e(S,{modelValue:f.value.type,"onUpdate:modelValue":o[3]||(o[3]=a=>f.value.type=a),options:Q,placeholder:"\u8BF7\u9009\u62E9\u6D41\u7A0B\u72B6\u6001",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["data","rules","disabled"])]),_:1},8,["visible","confirm-btn"]),e(be,{visible:B.value,"onUpdate:visible":o[5]||(o[5]=a=>B.value=a),"row-data":x.value},null,8,["visible","row-data"])])],2)}}}),Le=ce(we,[["__file","D:/Study/tdesign-console/src/views/flow/manager.vue"]]);export{Le as default};
