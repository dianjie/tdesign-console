import{a1 as U,d as Y,r as d,C as Q,az as W,ax as M,e as o,f as F,g as z,w as a,m as ne,l as e,q as Z,j as i,J as w,p as b,K as se,M as P,_ as ee,a as re,aE as ie,i as K,n as de}from"./index.ec7ccd34.js";import{u as me}from"./useDesign.9d0ca2bc.js";import{u as ce}from"./useSetting.1ce39974.js";import{u as pe}from"./useRequset.6e7c583c.js";import{u as X}from"./index.6fae05ac.js";const fe=(c,g,f)=>U.get({url:"/blade-system/param/list",params:{...f,current:c,size:g}},{joinTime:!1}),ve=c=>U.get({url:"/blade-system/param/detail",params:{id:c}}),_e=c=>U.post({url:"/blade-system/param/remove",params:{ids:c}},{joinParamsToUrl:!0,errorMessageMode:"message"}),be=c=>U.post({url:"/blade-system/param/submit",data:c}),ge=Y({__name:"DialogForm",props:{visible:{type:Boolean,default:!1},editId:{type:String,default:""},actionType:{type:String,default:""}},emits:["update:visible","update:editId","update:actionType","submit"],setup(c,{emit:g}){const f=c,E={paramName:"",paramKey:"",paramValue:""},A=d({paramName:[{required:!0,message:"\u8BF7\u8F93\u5165\u53C2\u6570\u540D\u79F0",type:"error",trigger:"blur"}],paramKey:[{required:!0,message:"\u8BF7\u8F93\u5165\u53C2\u6570\u952E\u540D",type:"error",trigger:"blur"}],paramValue:[{required:!0,message:"\u8BF7\u8F93\u5165\u53C2\u6570\u952E\u503C",type:"error",trigger:"blur"}]}),y=Q(()=>`${{view:"\u67E5\u770B",edit:"\u7F16\u8F91",add:"\u65B0\u589E"}[f.actionType]||""}\u53C2\u6570`),_=Q(()=>({view:!0,edit:!1})[f.actionType]||!1),s=d(!1),n=d({...E}),D=d(null),C=d(!1),T=({firstError:m})=>{if(m)P.warning(m);else{C.value=!0;const t={...n.value,id:f.editId};be(t).then(()=>{g("submit",t),P.success("\u63D0\u4EA4\u6210\u529F"),s.value=!1}).finally(()=>{C.value=!1})}},j=()=>{n.value={...E},M(()=>{g("update:editId",""),g("update:actionType","")})},h=()=>{s.value=!1};return W(()=>s.value,m=>{g("update:visible",m)}),W(()=>f.visible,m=>{m&&f.editId&&M(()=>{ve(f.editId).then(t=>{n.value={...t}})}),M(()=>{var t;(t=D.value)==null||t.clearValidate()}),s.value=m}),(m,t)=>{const N=o("t-input"),v=o("t-form-item"),V=o("t-col"),R=o("t-textarea"),$=o("t-button"),S=o("t-row"),q=o("t-form"),k=o("t-dialog");return F(),z(k,{visible:s.value,"onUpdate:visible":t[3]||(t[3]=r=>s.value=r),header:i(y),width:780,footer:!1,onClosed:j},{body:a(()=>[ne(" \u8868\u5355\u5185\u5BB9 "),e(q,{ref_key:"form",ref:D,class:Z({"xy-form__detail":c.actionType==="view"}),data:n.value,rules:A.value,"label-width":100,disabled:i(_)||C.value,onSubmit:T},{default:a(()=>[e(S,{gutter:[0,28]},{default:a(()=>[e(V,{span:12},{default:a(()=>[e(v,{label:"\u53C2\u6570\u540D\u79F0",name:"paramName"},{default:a(()=>[e(N,{modelValue:n.value.paramName,"onUpdate:modelValue":t[0]||(t[0]=r=>n.value.paramName=r),placeholder:"\u8BF7\u8F93\u5165\u53C2\u6570\u540D\u79F0",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(V,{span:12},{default:a(()=>[e(v,{label:"\u53C2\u6570\u952E\u540D",name:"paramKey"},{default:a(()=>[e(N,{modelValue:n.value.paramKey,"onUpdate:modelValue":t[1]||(t[1]=r=>n.value.paramKey=r),placeholder:"\u8BF7\u8F93\u5165\u53C2\u6570\u952E\u540D",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(V,{span:12},{default:a(()=>[e(v,{label:"\u53C2\u6570\u952E\u503C",name:"paramValue"},{default:a(()=>[e(R,{modelValue:n.value.paramValue,"onUpdate:modelValue":t[2]||(t[2]=r=>n.value.paramValue=r),placeholder:"\u8BF7\u8F93\u5165\u53C2\u6570\u952E\u503C",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),w(e(V,{span:12},{default:a(()=>[e(v,{style:{float:"right"}},{default:a(()=>[e($,{variant:"outline",onClick:h},{default:a(()=>[b("\u53D6\u6D88")]),_:1}),e($,{theme:"primary",type:"submit"},{default:a(()=>[b("\u786E\u5B9A")]),_:1})]),_:1})]),_:1},512),[[se,!i(_)]])]),_:1})]),_:1},8,["class","data","rules","disabled"])]),_:1},8,["visible","header"])}}}),ye=ee(ge,[["__file","D:/Study/tdesign-console/src/viewsBusiness/system/components/param/DialogForm.vue"]]),Ce=[{colKey:"row-select",type:"multiple",width:64,fixed:"left"},{colKey:"serial-number",title:"\u5E8F\u53F7",width:80,align:"center",fixed:"left"},{title:"\u53C2\u6570\u540D\u79F0",colKey:"paramName"},{title:"\u53C2\u6570\u952E\u540D",colKey:"paramKey"},{title:"\u53C2\u6570\u952E\u503C",colKey:"paramValue"},{fixed:"right",width:180,colKey:"op",title:"\u64CD\u4F5C",align:"center"}],Fe={class:"table-wrapper"},De=["onClick"],Ve=["onClick"],we=["onClick"],he=Y({__name:"param",setup(c){const{tableVar:g}=me(),{getTableHeaderAffixedTop:f,getLayoutContainer:E}=ce(),A={paramName:"",paramValue:""},y=d([]),_=d({...A}),s=d(!1),n=d(!1),D=d(""),C=d(""),{fetchData:T,data:j,pagination:h,dataLoading:m}=pe(fe,_.value,()=>{y.value=[]});re(()=>{T()});const t=({row:p},u)=>{D.value=p.id,C.value=u,n.value=!0},N=({row:p})=>{k.value=p.id,r.value="one",s.value=!0},v=X(()=>{T()},300),V=p=>{y.value=p},R=p=>{h.value={...h.value,current:p.current||1,pageSize:p.pageSize},v()},S=X(async p=>{try{await _e(p),s.value=!1,P.success("\u5220\u9664\u6210\u529F"),H(),v()}catch{s.value=!1}},300),q=()=>{!y.value.length||(r.value="check",s.value=!0)},k=d(-1),r=d(),H=()=>{k.value=-1,r.value=""},ae=()=>{r.value==="check"&&S(y.value),r.value==="one"&&S([`${k.value}`])},te=()=>{H()};return(p,u)=>{const J=o("t-input"),O=o("t-form-item"),B=o("t-col"),L=o("t-row"),I=o("t-button"),ue=o("t-form"),le=o("t-table"),oe=o("t-dialog"),x=ie("auth");return F(),K("div",{class:Z(i(g))},[e(ue,{ref:"form",data:_.value,"label-width":80,colon:"",style:{marginBottom:"8px"},onReset:i(v),onSubmit:i(v)},{default:a(()=>[e(L,null,{default:a(()=>[e(B,{span:10},{default:a(()=>[e(L,{gutter:[16,24]},{default:a(()=>[e(B,{span:4},{default:a(()=>[e(O,{label:"\u53C2\u6570\u540D\u79F0",name:"paramName"},{default:a(()=>[e(J,{modelValue:_.value.paramName,"onUpdate:modelValue":u[0]||(u[0]=l=>_.value.paramName=l),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u53C2\u6570\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),e(B,{span:4},{default:a(()=>[e(O,{label:"\u53C2\u6570\u952E\u540D",name:"paramValue"},{default:a(()=>[e(J,{modelValue:_.value.paramValue,"onUpdate:modelValue":u[1]||(u[1]=l=>_.value.paramValue=l),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u53C2\u6570\u952E\u540D"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(B,{span:2,class:"operation-wrapper"},{default:a(()=>[e(I,{theme:"primary",type:"submit",style:{marginLeft:"8px"}},{default:a(()=>[b(" \u67E5\u8BE2 ")]),_:1}),e(I,{type:"reset",variant:"base",theme:"default"},{default:a(()=>[b(" \u91CD\u7F6E ")]),_:1})]),_:1})]),_:1})]),_:1},8,["data","onReset","onSubmit"]),de("div",Fe,[e(le,{data:i(j),columns:i(Ce),hover:!0,loading:i(m),pagination:i(h),"selected-row-keys":y.value,"header-affixed-top":{offsetTop:i(f),container:i(E)},"vertical-align":"top","row-key":"id",bordered:"",stripe:"",onPageChange:R,onSelectChange:V},{"top-content":a(()=>[e(L,{justify:"space-between",style:{"margin-bottom":"10px"}},{default:a(()=>[e(B,{flex:"0 0 auto"},{default:a(()=>[w((F(),z(I,{onClick:u[2]||(u[2]=l=>t({row:{}},"add"))},{default:a(()=>[b("\u65B0\u589E")]),_:1})),[[x,"param_add"]]),w((F(),z(I,{theme:"danger",onClick:q},{default:a(()=>[b("\u5220\u9664")]),_:1})),[[x,"param_delete"]])]),_:1})]),_:1})]),op:a(l=>[w((F(),K("a",{class:"t-button-link",onClick:G=>t(l,"view")},[b("\u67E5\u770B")],8,De)),[[x,"param_view"]]),w((F(),K("a",{class:"t-button-link",onClick:G=>t(l,"edit")},[b("\u7F16\u8F91")],8,Ve)),[[x,"param_edit"]]),w((F(),K("a",{class:"t-button-link",onClick:G=>N(l)},[b("\u5220\u9664")],8,we)),[[x,"param_delete"]])]),_:1},8,["data","columns","loading","pagination","selected-row-keys","header-affixed-top"]),e(oe,{visible:s.value,"onUpdate:visible":u[3]||(u[3]=l=>s.value=l),header:"\u786E\u8BA4\u5220\u9664\u5F53\u524D\u6240\u9009\u6570\u636E\uFF1F","on-cancel":te,onConfirm:ae},null,8,["visible"]),e(ye,{visible:n.value,"onUpdate:visible":u[4]||(u[4]=l=>n.value=l),editId:D.value,"onUpdate:editId":u[5]||(u[5]=l=>D.value=l),actionType:C.value,"onUpdate:actionType":u[6]||(u[6]=l=>C.value=l),onSubmit:i(v)},null,8,["visible","editId","actionType","onSubmit"])])],2)}}}),Ne=ee(he,[["__file","D:/Study/tdesign-console/src/views/system/param.vue"]]);export{Ne as default};
