import{d as te,r,C as W,aJ as de,ax as Y,av as J,e as l,f as y,g as G,w as t,m as ce,l as e,q as ae,j as i,J as k,p as m,K as pe,M as H,_ as oe,aL as me,X as fe,a as ve,aG as _e,i as U,n as Fe,t as Z,aM as ge,aI as Ce,aC as be,aD as ye}from"./index.8ed3877a.js";import{g as De,s as Be,a as we,r as Ve}from"./post.c26f870b.js";import{u as he}from"./useDesign.9d0ca2bc.js";import{u as ke}from"./useSetting.01b849d1.js";import{u as xe}from"./useRequset.50973ce5.js";import{g as Te}from"./tenant.aad034d6.js";import{u as ee}from"./index.74383c1c.js";const Ee=[{colKey:"row-select",type:"multiple",width:64,fixed:"left"},{colKey:"serial-number",title:"\u5E8F\u53F7",width:80,align:"center",fixed:"left"},{title:"\u6240\u5C5E\u79DF\u6237",colKey:"tenantId"},{title:"\u5C97\u4F4D\u7C7B\u578B",colKey:"category"},{title:"\u5C97\u4F4D\u7F16\u53F7",colKey:"postCode"},{title:"\u5C97\u4F4D\u540D\u79F0",colKey:"postName"},{title:"\u5C97\u4F4D\u6392\u5E8F",colKey:"sort"},{fixed:"right",width:180,colKey:"op",title:"\u64CD\u4F5C",align:"center"}],Ie=te({__name:"DialogForm",props:{visible:{type:Boolean,default:!1},editId:{type:String,default:""},actionType:{type:String,default:""}},emits:["update:visible","update:editId","update:actionType","submit"],setup(K,{emit:D}){const _=K,E={category:"",postCode:"",postName:"",sort:void 0,remark:""},A=r({category:[{required:!0,message:"\u8BF7\u9009\u62E9\u5C97\u4F4D\u7C7B\u578B",type:"error",trigger:"change"}],postCode:[{required:!0,message:"\u8BF7\u8F93\u5165\u5C97\u4F4D\u7F16\u53F7",type:"error",trigger:"blur"}],postName:[{required:!0,message:"\u8BF7\u8F93\u5165\u5C97\u4F4D\u540D\u79F0",type:"error",trigger:"blur"}],sort:[{required:!0,message:"\u8BF7\u8F93\u5165\u5C97\u4F4D\u6392\u5E8F",type:"error",trigger:"blur"}]}),b=W(()=>`${{view:"\u67E5\u770B",edit:"\u7F16\u8F91",add:"\u65B0\u589E"}[_.actionType]||""}\u5C97\u4F4D`),p=W(()=>({view:!0,edit:!1})[_.actionType]||!1),F=de("postCategoryOptions")||[],f=r(!1),n=r({...E}),B=r(null),w=r(!1),V=({firstError:c})=>{if(c)H.warning(c);else{w.value=!0;const a={...n.value,id:_.editId};Be(a).then(()=>{D("submit",a),H.success("\u63D0\u4EA4\u6210\u529F"),f.value=!1}).finally(()=>{w.value=!1})}},L=()=>{n.value={...E},J(()=>{D("update:editId",""),D("update:actionType","")})},I=()=>{f.value=!1};return Y(()=>f.value,c=>{D("update:visible",c)}),Y(()=>_.visible,c=>{c&&_.editId&&J(()=>{De(_.editId).then(a=>{n.value={...a}})}),J(()=>{var a;(a=B.value)==null||a.clearValidate()}),f.value=c}),(c,a)=>{const j=l("t-select"),v=l("t-form-item"),g=l("t-col"),C=l("t-input"),O=l("t-input-number"),R=l("t-textarea"),$=l("t-button"),N=l("t-row"),q=l("t-form"),x=l("t-dialog");return y(),G(x,{visible:f.value,"onUpdate:visible":a[5]||(a[5]=s=>f.value=s),header:i(b),width:780,footer:!1,onClosed:L},{body:t(()=>[ce(" \u8868\u5355\u5185\u5BB9 "),e(q,{ref_key:"form",ref:B,class:ae({"xy-form__detail":K.actionType==="view"}),data:n.value,rules:A.value,"label-width":100,disabled:i(p)||w.value,onSubmit:V},{default:t(()=>[e(N,{gutter:[0,28]},{default:t(()=>[e(g,{span:6},{default:t(()=>[e(v,{label:"\u5C97\u4F4D\u7C7B\u578B",name:"category"},{default:t(()=>[e(j,{modelValue:n.value.category,"onUpdate:modelValue":a[0]||(a[0]=s=>n.value.category=s),options:i(F),keys:{value:"dictKey",label:"dictValue"},clearable:"",placeholder:"\u8BF7\u9009\u62E9\u5C97\u4F4D\u7C7B\u578B"},null,8,["modelValue","options"])]),_:1})]),_:1}),e(g,{span:6},{default:t(()=>[e(v,{label:"\u5C97\u4F4D\u7F16\u53F7",name:"postCode"},{default:t(()=>[e(C,{modelValue:n.value.postCode,"onUpdate:modelValue":a[1]||(a[1]=s=>n.value.postCode=s),placeholder:"\u8BF7\u8F93\u5165\u5C97\u4F4D\u7F16\u53F7",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(g,{span:6},{default:t(()=>[e(v,{label:"\u5C97\u4F4D\u540D\u79F0",name:"postName"},{default:t(()=>[e(C,{modelValue:n.value.postName,"onUpdate:modelValue":a[2]||(a[2]=s=>n.value.postName=s),placeholder:"\u8BF7\u8F93\u5165\u5C97\u4F4D\u540D\u79F0",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(g,{span:6},{default:t(()=>[e(v,{label:"\u5C97\u4F4D\u6392\u5E8F",name:"sort"},{default:t(()=>[e(O,{modelValue:n.value.sort,"onUpdate:modelValue":a[3]||(a[3]=s=>n.value.sort=s),theme:"column",placeholder:"\u8BF7\u8F93\u5165\u5C97\u4F4D\u6392\u5E8F",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(g,{span:12},{default:t(()=>[e(v,{label:"\u5C97\u4F4D\u63CF\u8FF0",name:"remark"},{default:t(()=>[e(R,{modelValue:n.value.remark,"onUpdate:modelValue":a[4]||(a[4]=s=>n.value.remark=s),placeholder:"\u8BF7\u8F93\u5165\u5C97\u4F4D\u63CF\u8FF0",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),k(e(g,{span:12},{default:t(()=>[e(v,{style:{float:"right"}},{default:t(()=>[e($,{variant:"outline",onClick:I},{default:t(()=>[m("\u53D6\u6D88")]),_:1}),e($,{theme:"primary",type:"submit"},{default:t(()=>[m("\u786E\u5B9A")]),_:1})]),_:1})]),_:1},512),[[pe,!i(p)]])]),_:1})]),_:1},8,["class","data","rules","disabled"])]),_:1},8,["visible","header"])}}}),Ne=oe(Ie,[["__file","D:/Study/tdesign-console/src/viewsBusiness/system/components/post/DialogForm.vue"]]),Se={class:"table-wrapper"},Ue=["onClick"],Ke=["onClick"],Ae=["onClick"],Le=te({__name:"post",setup(K){const{tableVar:D}=he(),{getTableHeaderAffixedTop:_,getLayoutContainer:E}=ke(),A={category:"",postCode:"",postName:""},b=r([]),p=r({...A}),F=r(!1),f=r(!1),n=r(""),B=r(""),w=r([]),V=r([]);async function L(){const d=await Te(),u=await be("post_category");w.value=d,V.value=ye(u)}me("postCategoryOptions",V),fe(()=>{L()});const{fetchData:I,data:c,pagination:a,dataLoading:j}=xe(we,p.value,()=>{b.value=[]});ve(()=>{I()});const v=({row:d},u)=>{n.value=d.id,B.value=u,f.value=!0},g=({row:d})=>{x.value=d.id,s.value="one",F.value=!0},C=ee(()=>{I()},300),O=d=>{b.value=d},R=d=>{a.value={...a.value,current:d.current||1,pageSize:d.pageSize},C()},N=ee(async d=>{try{await Ve(d),F.value=!1,H.success("\u5220\u9664\u6210\u529F"),P(),C()}catch{F.value=!1}},300),q=()=>{!b.value.length||(s.value="check",F.value=!0)},x=r(-1),s=r(),P=()=>{x.value=-1,s.value=""},ue=()=>{s.value==="check"&&N(b.value),s.value==="one"&&N([`${x.value}`])},le=()=>{P()};return(d,u)=>{const ne=l("t-select"),M=l("t-form-item"),h=l("t-col"),X=l("t-input"),z=l("t-row"),S=l("t-button"),se=l("t-form"),ie=l("t-table"),re=l("t-dialog"),T=_e("auth");return y(),U("div",{class:ae(i(D))},[e(se,{ref:"form",data:p.value,"label-width":80,colon:"",style:{marginBottom:"8px"},onReset:i(C),onSubmit:i(C)},{default:t(()=>[e(z,null,{default:t(()=>[e(h,{span:10},{default:t(()=>[e(z,{gutter:[16,24]},{default:t(()=>[e(h,{span:4},{default:t(()=>[e(M,{label:"\u5C97\u4F4D\u7C7B\u578B",name:"category"},{default:t(()=>[e(ne,{modelValue:p.value.category,"onUpdate:modelValue":u[0]||(u[0]=o=>p.value.category=o),options:V.value,keys:{value:"dictKey",label:"dictValue"},clearable:"",placeholder:"\u8BF7\u9009\u62E9\u5C97\u4F4D\u7C7B\u578B"},null,8,["modelValue","options"])]),_:1})]),_:1}),e(h,{span:4},{default:t(()=>[e(M,{label:"\u5C97\u4F4D\u7F16\u53F7",name:"postCode"},{default:t(()=>[e(X,{modelValue:p.value.postCode,"onUpdate:modelValue":u[1]||(u[1]=o=>p.value.postCode=o),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5C97\u4F4D\u7F16\u53F7"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,{span:4},{default:t(()=>[e(M,{label:"\u5C97\u4F4D\u540D\u79F0",name:"postName"},{default:t(()=>[e(X,{modelValue:p.value.postName,"onUpdate:modelValue":u[2]||(u[2]=o=>p.value.postName=o),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5C97\u4F4D\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(h,{span:2,class:"operation-wrapper"},{default:t(()=>[e(S,{theme:"primary",type:"submit",style:{marginLeft:"8px"}},{default:t(()=>[m(" \u67E5\u8BE2 ")]),_:1}),e(S,{type:"reset",variant:"base",theme:"default"},{default:t(()=>[m(" \u91CD\u7F6E ")]),_:1})]),_:1})]),_:1})]),_:1},8,["data","onReset","onSubmit"]),Fe("div",Se,[e(ie,{data:i(c),columns:i(Ee),hover:!0,loading:i(j),pagination:i(a),"selected-row-keys":b.value,"header-affixed-top":{offsetTop:i(_),container:i(E)},"vertical-align":"top","row-key":"id",bordered:"",stripe:"",onPageChange:R,onSelectChange:O},{"top-content":t(()=>[e(z,{justify:"space-between",style:{"margin-bottom":"10px"}},{default:t(()=>[e(h,{flex:"0 0 auto"},{default:t(()=>[k((y(),G(S,{onClick:u[3]||(u[3]=o=>v({row:{}},"add"))},{default:t(()=>[m("\u65B0\u589E")]),_:1})),[[T,"post_add"]]),k((y(),G(S,{theme:"danger",onClick:q},{default:t(()=>[m("\u5220\u9664")]),_:1})),[[T,"post_delete"]])]),_:1})]),_:1})]),tenantId:t(({row:o})=>[m(Z(i(ge)(w.value,o.tenantId,{id:"tenantId",name:"tenantName"})),1)]),category:t(({row:o})=>[m(Z(i(Ce)(V.value,o.category)),1)]),op:t(o=>[k((y(),U("a",{class:"t-button-link",onClick:Q=>v(o,"view")},[m("\u67E5\u770B")],8,Ue)),[[T,"post_view"]]),k((y(),U("a",{class:"t-button-link",onClick:Q=>v(o,"edit")},[m("\u7F16\u8F91")],8,Ke)),[[T,"post_edit"]]),k((y(),U("a",{class:"t-button-link",onClick:Q=>g(o)},[m("\u5220\u9664")],8,Ae)),[[T,"post_delete"]])]),_:1},8,["data","columns","loading","pagination","selected-row-keys","header-affixed-top"]),e(re,{visible:F.value,"onUpdate:visible":u[4]||(u[4]=o=>F.value=o),header:"\u786E\u8BA4\u5220\u9664\u5F53\u524D\u6240\u9009\u6570\u636E\uFF1F","on-cancel":le,onConfirm:ue},null,8,["visible"]),e(Ne,{visible:f.value,"onUpdate:visible":u[5]||(u[5]=o=>f.value=o),editId:n.value,"onUpdate:editId":u[6]||(u[6]=o=>n.value=o),actionType:B.value,"onUpdate:actionType":u[7]||(u[7]=o=>B.value=o),onSubmit:i(C)},null,8,["visible","editId","actionType","onSubmit"])])],2)}}}),Je=oe(Le,[["__file","D:/Study/tdesign-console/src/views/system/post.vue"]]);export{Je as default};
