import{d as E,aC as H,f as m,i as P,l as W,r as i,as as j,o as f,c as _,a as e,w as t,b as n,q as r,e as G,W as k,t as C,s as J,at as Q}from"./index-CqGaQ7t4.js";import{s as X}from"./work-EOGau8jX.js";import{_ as Y}from"./index.vue_vue_type_script_setup_true_lang-ojmq6q2F.js";import{u as Z}from"./useSetting-CnYQd1RY.js";import{u as ee}from"./useDesign-CbWcZHFZ.js";import{u as te}from"./useRequset-Bj5fiv5N.js";import{g as oe,f as ae}from"./flowHelper-BpDILVBW.js";import{u as ne}from"./index-BidCcHov.js";import"./flow-DzSZmebQ.js";const se=[{colKey:"serial-number",title:"序号",width:80,align:"center",fixed:"left"},{title:"流程分类",colKey:"categoryName"},{title:"流程名称",colKey:"processDefinitionName"},{title:"当前步骤",colKey:"taskName"},{title:"流程版本",colKey:"processDefinitionVersion"},{title:"流程进度",colKey:"processIsFinished"},{title:"申请时间",colKey:"createTime"},{fixed:"right",width:180,colKey:"op",title:"操作",align:"center"}],ie={class:"table-wrapper"},le=["onClick"],re=["onClick"],be=E({__name:"send",setup(ce){const{tableVar:x}=ee(),{getTableHeaderAffixedTop:F,getLayoutContainer:N}=Z(),K={category:"",processDefinitionName:""},g=H(),l=m({...K}),S=g.getFlowDict,{fetchData:I,data:R,pagination:u,dataLoading:$}=te(X,l.value,Q),v=()=>{I({...l.value,category:oe(l.value.category)})};P(()=>{v()});const d=ne(()=>{v()},300),L=s=>{u.value={...u.value,current:s.current||1,pageSize:s.pageSize},d()},p=m(!1),y=m({}),T=({row:s})=>{y.value=s,p.value=!0},B=W(),U=({row:s})=>{B.push({path:`/work/process/${ae(g.getFlowRoutes,s.category)}/detail/${s.processInstanceId}/${s.businessId}`})};return(s,o)=>{const z=i("t-select"),b=i("t-form-item"),c=i("t-col"),q=i("t-input"),h=i("t-row"),w=i("t-button"),M=i("t-form"),D=i("t-tag"),O=i("t-table"),V=j("auth");return f(),_("div",{class:J(n(x))},[e(M,{ref:"form",data:l.value,"label-width":80,colon:"",style:{marginBottom:"8px"},onReset:n(d),onSubmit:n(d)},{default:t(()=>[e(h,null,{default:t(()=>[e(c,{span:10},{default:t(()=>[e(h,{gutter:[16,24]},{default:t(()=>[e(c,{span:4},{default:t(()=>[e(b,{label:"流程分类",name:"category"},{default:t(()=>[e(z,{modelValue:l.value.category,"onUpdate:modelValue":o[0]||(o[0]=a=>l.value.category=a),options:n(S),keys:{value:"dictKey",label:"dictValue"},clearable:"",placeholder:"请选择流程分类"},null,8,["modelValue","options"])]),_:1})]),_:1}),e(c,{span:4},{default:t(()=>[e(b,{label:"流程名称",name:"processDefinitionName"},{default:t(()=>[e(q,{modelValue:l.value.processDefinitionName,"onUpdate:modelValue":o[1]||(o[1]=a=>l.value.processDefinitionName=a),clearable:"",placeholder:"请输入流程名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(c,{span:2,class:"operation-wrapper"},{default:t(()=>[e(w,{theme:"primary",type:"submit",style:{marginLeft:"8px"}},{default:t(()=>o[3]||(o[3]=[r(" 查询 ")])),_:1}),e(w,{type:"reset",variant:"base",theme:"default"},{default:t(()=>o[4]||(o[4]=[r(" 重置 ")])),_:1})]),_:1})]),_:1})]),_:1},8,["data","onReset","onSubmit"]),G("div",ie,[e(O,{data:n(R),columns:n(se),hover:!0,loading:n($),pagination:n(u),"header-affixed-top":{offsetTop:n(F),container:n(N)},"vertical-align":"top","row-key":"id",bordered:"",stripe:"",onPageChange:L},{op:t(a=>[k((f(),_("a",{class:"t-button-link",onClick:A=>U(a)},o[5]||(o[5]=[r("详情")]),8,le)),[[V,"work_send_detail"]]),k((f(),_("a",{class:"t-button-link",onClick:A=>T(a)},o[6]||(o[6]=[r("流程图")]),8,re)),[[V,"work_send_follow"]])]),processDefinitionVersion:t(({row:a})=>[e(D,{theme:"primary",variant:"light"},{default:t(()=>[r("v"+C(a.processDefinitionVersion),1)]),_:2},1024)]),processIsFinished:t(({row:a})=>[e(D,{theme:"primary",variant:"light"},{default:t(()=>[r(C(a.processIsFinished==="finished"?"已完成":"未完成"),1)]),_:2},1024)]),_:1},8,["data","columns","loading","pagination","header-affixed-top"]),e(Y,{visible:p.value,"onUpdate:visible":o[2]||(o[2]=a=>p.value=a),"row-data":y.value,type:"diagram"},null,8,["visible","row-data"])])],2)}}});export{be as default};
