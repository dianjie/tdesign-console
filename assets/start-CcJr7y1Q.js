import{d as P,aC as W,f as m,i as G,l as J,r as n,as as Q,o as v,c as y,a as e,w as t,b as l,q as s,e as X,W as D,t as b,s as Y,at as Z}from"./index-CqGaQ7t4.js";import{e as tt}from"./work-EOGau8jX.js";import{_ as et}from"./index.vue_vue_type_script_setup_true_lang-ojmq6q2F.js";import{u as ot}from"./useSetting-CnYQd1RY.js";import{u as at}from"./useDesign-CbWcZHFZ.js";import{u as nt}from"./useRequset-Bj5fiv5N.js";import{g as lt,f as st}from"./flowHelper-BpDILVBW.js";import{u as rt}from"./index-BidCcHov.js";import"./flow-DzSZmebQ.js";const it=[{colKey:"serial-number",title:"序号",width:80,align:"center",fixed:"left"},{title:"租户编号",colKey:"tenantId"},{title:"流程分类",colKey:"categoryName"},{title:"流程标识",colKey:"key"},{title:"流程名称",colKey:"name"},{title:"流程版本",colKey:"version"},{title:"状态",colKey:"suspensionState"},{title:"部署时间",colKey:"deploymentTime"},{fixed:"right",width:210,colKey:"op",title:"操作",align:"center"}],ut={class:"table-wrapper"},dt=["onClick"],mt=["onClick"],Ct=P({__name:"start",setup(pt){const{tableVar:K}=at(),{getTableHeaderAffixedTop:F,getLayoutContainer:R}=ot(),I={category:"",name:""},w=W(),r=m({...I}),L=w.getFlowDict,p=m("1"),{fetchData:N,data:T,pagination:c,dataLoading:U}=nt(tt,r.value,Z),h=()=>{N({...r.value,category:lt(r.value.category),mode:p.value})};G(()=>{h()});const d=rt(()=>{h()},300),$=i=>{c.value={...c.value,current:i.current||1,pageSize:i.pageSize},d()},f=m(!1),C=m({}),B=({row:i})=>{C.value=i,f.value=!0},z=J(),q=({row:i})=>{z.push({path:`/work/process/${st(w.getFlowRoutes,i.category)}/form/${i.id}`})};return(i,o)=>{const M=n("t-select"),V=n("t-form-item"),u=n("t-col"),O=n("t-input"),_=n("t-row"),k=n("t-button"),j=n("t-form"),x=n("t-radio-button"),A=n("t-radio-group"),g=n("t-tag"),E=n("t-table"),S=Q("auth");return v(),y("div",{class:Y(l(K))},[e(j,{ref:"form",data:r.value,"label-width":80,colon:"",style:{marginBottom:"8px"},onReset:l(d),onSubmit:l(d)},{default:t(()=>[e(_,null,{default:t(()=>[e(u,{span:10},{default:t(()=>[e(_,{gutter:[16,24]},{default:t(()=>[e(u,{span:4},{default:t(()=>[e(V,{label:"流程分类",name:"category"},{default:t(()=>[e(M,{modelValue:r.value.category,"onUpdate:modelValue":o[0]||(o[0]=a=>r.value.category=a),options:l(L),keys:{value:"dictKey",label:"dictValue"},clearable:"",placeholder:"请选择流程分类"},null,8,["modelValue","options"])]),_:1})]),_:1}),e(u,{span:4},{default:t(()=>[e(V,{label:"流程名称",name:"name"},{default:t(()=>[e(O,{modelValue:r.value.name,"onUpdate:modelValue":o[1]||(o[1]=a=>r.value.name=a),clearable:"",placeholder:"请输入流程名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(u,{span:2,class:"operation-wrapper"},{default:t(()=>[e(k,{theme:"primary",type:"submit",style:{marginLeft:"8px"}},{default:t(()=>o[4]||(o[4]=[s(" 查询 ")])),_:1}),e(k,{type:"reset",variant:"base",theme:"default"},{default:t(()=>o[5]||(o[5]=[s(" 重置 ")])),_:1})]),_:1})]),_:1})]),_:1},8,["data","onReset","onSubmit"]),X("div",ut,[e(E,{data:l(T),columns:l(it),hover:!0,loading:l(U),pagination:l(c),"header-affixed-top":{offsetTop:l(F),container:l(R)},"vertical-align":"top","row-key":"id",bordered:"",stripe:"",onPageChange:$},{"top-content":t(()=>[e(_,{justify:"space-between",style:{"margin-bottom":"10px"}},{default:t(()=>[e(u,{flex:"0 0 auto"},{default:t(()=>[e(A,{modelValue:p.value,"onUpdate:modelValue":o[2]||(o[2]=a=>p.value=a),onChange:l(d)},{default:t(()=>[e(x,{value:"1"},{default:t(()=>o[6]||(o[6]=[s("通用流程")])),_:1}),e(x,{value:"2"},{default:t(()=>o[7]||(o[7]=[s("定制流程")])),_:1})]),_:1},8,["modelValue","onChange"])]),_:1})]),_:1})]),op:t(a=>[D((v(),y("a",{class:"t-button-link",onClick:H=>q(a)},o[8]||(o[8]=[s("发起")]),8,dt)),[[S,"work_start_flow"]]),D((v(),y("a",{class:"t-button-link",onClick:H=>B(a)},o[9]||(o[9]=[s("流程图")]),8,mt)),[[S,"work_start_image"]])]),tenantId:t(({row:a})=>[e(g,{theme:"primary",variant:"light"},{default:t(()=>[s(b(a.tenantId?a.tenantId:"通用"),1)]),_:2},1024)]),version:t(({row:a})=>[e(g,{theme:"primary",variant:"light"},{default:t(()=>[s("v"+b(a.version),1)]),_:2},1024)]),suspensionState:t(({row:a})=>[e(g,{theme:"primary",variant:"light"},{default:t(()=>[s(b(a.suspensionState===1?"激活":"挂起"),1)]),_:2},1024)]),_:1},8,["data","columns","loading","pagination","header-affixed-top"]),e(et,{visible:f.value,"onUpdate:visible":o[3]||(o[3]=a=>f.value=a),"row-data":C.value},null,8,["visible","row-data"])])],2)}}});export{Ct as default};
