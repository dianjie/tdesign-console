import{a as pe,d as Ue,b as Te,s as xe,p as Se,c as Ne,e as De,f as $e,r as Ae}from"./tenant-L_eKxp0f.js";import{u as Be}from"./useSetting-oU45HIOI.js";import{u as je}from"./useDesign-CbWcZHFZ.js";import{d as Q,g as s,a3 as q,X as O,aj as ve,r as l,o as K,n as F,w as t,a as e,s as b,M as $,R as se,v as fe,a0 as J,a1 as ye,as as ne,aX as ke,b as _,e as le,aB as Ke,j as Re,ax as Le,c as ue,q as ie,t as ge}from"./index-C3aixgX8.js";import{u as Ie}from"./useRequset-DXnVyzrU.js";import{u as Me}from"./oss-CoeRlhxY.js";import{u as H}from"./index-C0FKHvC_.js";const Oe=Q({__name:"DialogDatasource",props:{visible:{type:Boolean,default:!1},editId:{type:String,default:""}},emits:["update:visible","update:editId","submit"],setup(U,{emit:R}){const w={datasourceId:"",tenantId:""},c=U,B=s({datasourceId:[{required:!0,message:"请选择数据源",type:"error",trigger:"change"}]}),m=s(!1),n=s({...w}),r=s(null),o=s(!1),g=R,p=({firstError:C})=>{C?$.warning(C):(o.value=!0,Ue(n.value.tenantId,n.value.datasourceId).then(()=>{g("submit",{}),$.success("提交成功"),m.value=!1}).finally(()=>{o.value=!1}))},h=()=>{n.value={...w},O(()=>{g("update:editId","")})},L=()=>{m.value=!1};q(()=>m.value,C=>{g("update:visible",C)}),q(()=>c.visible,C=>{C&&c.editId&&O(()=>{c.editId.split(",").length===1?pe(c.editId).then(f=>{n.value={datasourceId:f.datasourceId,tenantId:f.tenantId}}):n.value={...w}}),O(()=>{var f;(f=r.value)==null||f.clearValidate()}),m.value=C});const V=s([]);async function v(){const C=await Te();V.value=C}return ve(()=>{v()}),(C,f)=>{const u=l("t-select"),a=l("t-form-item"),y=l("t-col"),k=l("t-button"),T=l("t-row"),M=l("t-form"),N=l("t-dialog");return K(),F(N,{visible:m.value,"onUpdate:visible":f[1]||(f[1]=D=>m.value=D),header:"租户数据源配置",width:480,footer:!1,onClosed:h},{body:t(()=>[e(M,{ref_key:"form",ref:r,data:n.value,rules:B.value,"label-width":100,disabled:o.value,onSubmit:p},{default:t(()=>[e(T,{gutter:[0,28]},{default:t(()=>[e(y,{span:12},{default:t(()=>[e(a,{label:"数据源",name:"datasourceId"},{default:t(()=>[e(u,{modelValue:n.value.datasourceId,"onUpdate:modelValue":f[0]||(f[0]=D=>n.value.datasourceId=D),options:V.value,keys:{value:"id",label:"name"},clearable:"",placeholder:"请选择数据源"},null,8,["modelValue","options"])]),_:1})]),_:1}),e(y,{span:12},{default:t(()=>[e(a,{style:{float:"right"}},{default:t(()=>[e(k,{variant:"outline",onClick:L},{default:t(()=>[b("取消")]),_:1}),e(k,{theme:"primary",type:"submit"},{default:t(()=>[b("确定")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["data","rules","disabled"])]),_:1},8,["visible"])}}}),qe=Q({__name:"DialogForm",props:{visible:{type:Boolean,default:!1},editId:{type:String,default:""},actionType:{type:String,default:""}},emits:["update:visible","update:editId","update:actionType","submit"],setup(U,{emit:R}){const w={tenantName:"",linkman:"",contactNumber:"",address:"",domainUrl:"",backgroundUrl:[]},c=U,B=s({tenantName:[{required:!0,message:"请输入租户名称",type:"error",trigger:"blur"}],linkman:[{required:!0,message:"请输入联系人",type:"error",trigger:"blur"}]}),m=se(()=>`${{view:"查看",edit:"编辑",add:"新增"}[c.actionType]||""}租户`),n=se(()=>({view:!0,edit:!1})[c.actionType]||!1),r=s(!1),o=s({...w}),g=s(null),p=s(!1),h=R,L=({firstError:u})=>{var a;if(u)$.warning(u);else{p.value=!0;const y={...o.value,backgroundUrl:o.value.backgroundUrl.length?(a=o.value.backgroundUrl[0])==null?void 0:a.url:"",id:c.editId};xe(y).then(()=>{h("submit",y),$.success("提交成功"),r.value=!1}).finally(()=>{p.value=!1})}},V=()=>{o.value={...w},O(()=>{h("update:editId",""),h("update:actionType","")})},v=()=>{r.value=!1};q(()=>r.value,u=>{h("update:visible",u)}),q(()=>c.visible,u=>{u&&c.editId&&O(()=>{pe(c.editId).then(a=>{o.value={...a,backgroundUrl:a.backgroundUrl?[{url:a.backgroundUrl}]:[]}})}),O(()=>{var a;(a=g.value)==null||a.clearValidate()}),r.value=u});const C=({file:u})=>{$.error(`文件 ${u.name} 上传失败`)},f=async u=>{try{const a=await Me({file:u.raw});return{status:"success",response:{...a,url:a.link}}}catch{return{status:"fail",error:"上传失败"}}};return(u,a)=>{const y=l("t-input"),k=l("t-form-item"),T=l("t-col"),M=l("t-upload"),N=l("t-button"),D=l("t-row"),A=l("t-form"),P=l("t-dialog");return K(),F(P,{visible:r.value,"onUpdate:visible":a[6]||(a[6]=I=>r.value=I),header:m.value,width:780,footer:!1,onClosed:V},{body:t(()=>[e(A,{ref_key:"form",ref:g,class:fe({"xy-form__detail":U.actionType==="view"}),data:o.value,rules:B.value,"label-width":100,disabled:n.value||p.value,onSubmit:L},{default:t(()=>[e(D,{gutter:[0,28]},{default:t(()=>[e(T,{span:12},{default:t(()=>[e(k,{label:"租户名称",name:"tenantName"},{default:t(()=>[e(y,{modelValue:o.value.tenantName,"onUpdate:modelValue":a[0]||(a[0]=I=>o.value.tenantName=I),placeholder:"请输入租户名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(T,{span:6},{default:t(()=>[e(k,{label:"联系人",name:"linkman"},{default:t(()=>[e(y,{modelValue:o.value.linkman,"onUpdate:modelValue":a[1]||(a[1]=I=>o.value.linkman=I),placeholder:"请输入联系人",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(T,{span:6},{default:t(()=>[e(k,{label:"联系电话",name:"contactNumber"},{default:t(()=>[e(y,{modelValue:o.value.contactNumber,"onUpdate:modelValue":a[2]||(a[2]=I=>o.value.contactNumber=I),placeholder:"请输入联系电话",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(T,{span:12},{default:t(()=>[e(k,{label:"联系地址",name:"address"},{default:t(()=>[e(y,{modelValue:o.value.address,"onUpdate:modelValue":a[3]||(a[3]=I=>o.value.address=I),theme:"column",placeholder:"请输入联系地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(T,{span:12},{default:t(()=>[e(k,{label:"绑定域名",name:"domainUrl"},{default:t(()=>[e(y,{modelValue:o.value.domainUrl,"onUpdate:modelValue":a[4]||(a[4]=I=>o.value.domainUrl=I),theme:"column",placeholder:"请输入绑定域名",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(T,{span:12},{default:t(()=>[e(k,{label:"背景图片",name:"backgroundUrl"},{default:t(()=>[e(M,{ref:"uploadRef",modelValue:o.value.backgroundUrl,"onUpdate:modelValue":a[5]||(a[5]=I=>o.value.backgroundUrl=I),theme:"image",tips:"单张图片文件上传",accept:"image/*",locale:{triggerUploadText:{image:"请选择图片"}},"request-method":f,disabled:n.value||p.value,onFail:C},null,8,["modelValue","disabled"])]),_:1})]),_:1}),J(e(T,{span:12},{default:t(()=>[e(k,{style:{float:"right"}},{default:t(()=>[e(N,{variant:"outline",onClick:v},{default:t(()=>[b("取消")]),_:1}),e(N,{theme:"primary",type:"submit"},{default:t(()=>[b("确定")]),_:1})]),_:1})]),_:1},512),[[ye,!n.value]])]),_:1})]),_:1},8,["class","data","rules","disabled"])]),_:1},8,["visible","header"])}}}),Fe=(U,R,w)=>ne.get({url:"/blade-system/tenant-package/list",params:{...w,current:U,size:R}}),we=U=>ne.get({url:"/blade-system/tenant-package/detail",params:{id:U}}),Pe=U=>ne.post({url:"/blade-system/tenant-package/remove",params:{ids:U}},{joinParamsToUrl:!0,errorMessageMode:"message"}),ze=U=>ne.post({url:"/blade-system/tenant-package/submit",data:U}),Xe=()=>ne.get({url:"/blade-system/tenant-package/select"}),He=Q({__name:"DialogPackage",props:{visible:{type:Boolean,default:!1},editId:{type:String,default:""},tenantId:{type:String,default:""}},emits:["update:visible","update:editId","submit"],setup(U,{emit:R}){const w={packageId:"",menuId:[]},c=U,B=s({}),m=s(!1),n=s({...w}),r=s(null),o=s(!1),g=R,p=({firstError:u})=>{u?$.warning(u):(o.value=!0,Ne(c.tenantId,n.value.packageId).then(()=>{g("submit",{}),$.success("提交成功"),m.value=!1}).finally(()=>{o.value=!1}))},h=()=>{n.value={...w},O(()=>{g("update:editId","")})},L=()=>{m.value=!1},V=s([]),v=s([]);async function C(){const u=await ke();V.value=u}function f(){Xe().then(u=>{v.value=u})}return ve(()=>{C()}),q(()=>m.value,u=>{g("update:visible",u)}),q(()=>c.visible,u=>{u&&f(),u&&c.editId&&O(()=>{c.editId.split(",").length===1?Se(c.editId).then(a=>{var y;n.value={packageId:a.id,menuId:((y=a.menuId)==null?void 0:y.split(","))||[]}}):n.value={...w}}),O(()=>{var a;(a=r.value)==null||a.clearValidate()}),m.value=u}),q(()=>n.value.packageId,u=>{u?we(u).then(a=>{n.value.menuId=a.menuId.split(",")}):n.value={...w}}),(u,a)=>{const y=l("t-select"),k=l("t-form-item"),T=l("t-col"),M=l("t-tree-select"),N=l("t-button"),D=l("t-row"),A=l("t-form"),P=l("t-dialog");return K(),F(P,{visible:m.value,"onUpdate:visible":a[2]||(a[2]=I=>m.value=I),header:"租户产品包配置",width:480,footer:!1,onClosed:h},{body:t(()=>[e(A,{ref_key:"form",ref:r,data:n.value,rules:B.value,"label-width":100,disabled:o.value,onSubmit:p},{default:t(()=>[e(D,{gutter:[0,28]},{default:t(()=>[e(T,{span:12},{default:t(()=>[e(k,{label:"产品包",name:"packageId"},{default:t(()=>[e(y,{modelValue:n.value.packageId,"onUpdate:modelValue":a[0]||(a[0]=I=>n.value.packageId=I),options:v.value,keys:{value:"id",label:"packageName"},clearable:"",placeholder:"请选择产品包"},null,8,["modelValue","options"])]),_:1})]),_:1}),e(T,{span:12},{default:t(()=>[e(k,{label:"菜单预览",name:"menuId"},{default:t(()=>[e(M,{modelValue:n.value.menuId,"onUpdate:modelValue":a[1]||(a[1]=I=>n.value.menuId=I),data:V.value,"tree-props":{keys:{value:"id",label:"title"},valueMode:"all"},multiple:"",clearable:""},null,8,["modelValue","data"])]),_:1})]),_:1}),e(T,{span:12},{default:t(()=>[e(k,{style:{float:"right"}},{default:t(()=>[e(N,{variant:"outline",onClick:L},{default:t(()=>[b("取消")]),_:1}),e(N,{theme:"primary",type:"submit"},{default:t(()=>[b("确定")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["data","rules","disabled"])]),_:1},8,["visible"])}}}),Ge=Q({__name:"DialogSetting",props:{visible:{type:Boolean,default:!1},editId:{type:String,default:""}},emits:["update:visible","update:editId","submit"],setup(U,{emit:R}){const w={accountNumber:-1,expireTime:""},c=U,B=s({}),m=s(!1),n=s({...w}),r=s(null),o=s(!1),g=R,p=({firstError:V})=>{if(V)$.warning(V);else{o.value=!0;const v={...n.value,ids:c.editId};De(v).then(()=>{g("submit",v),$.success("提交成功"),m.value=!1}).finally(()=>{o.value=!1})}},h=()=>{n.value={...w},O(()=>{g("update:editId","")})},L=()=>{m.value=!1};return q(()=>m.value,V=>{g("update:visible",V)}),q(()=>c.visible,V=>{V&&c.editId&&O(()=>{c.editId.split(",").length===1?pe(c.editId).then(v=>{n.value={accountNumber:v.accountNumber,expireTime:v.expireTime}}):n.value={...w}}),O(()=>{var v;(v=r.value)==null||v.clearValidate()}),m.value=V}),(V,v)=>{const C=l("t-input-number"),f=l("t-form-item"),u=l("t-col"),a=l("t-date-picker"),y=l("t-button"),k=l("t-row"),T=l("t-form"),M=l("t-dialog");return K(),F(M,{visible:m.value,"onUpdate:visible":v[2]||(v[2]=N=>m.value=N),header:"租户授权配置",width:480,footer:!1,onClosed:h},{body:t(()=>[e(T,{ref_key:"form",ref:r,data:n.value,rules:B.value,"label-width":100,disabled:o.value,onSubmit:p},{default:t(()=>[e(k,{gutter:[0,28]},{default:t(()=>[e(u,{span:12},{default:t(()=>[e(f,{label:"账号额度",name:"accountNumber"},{default:t(()=>[e(C,{modelValue:n.value.accountNumber,"onUpdate:modelValue":v[0]||(v[0]=N=>n.value.accountNumber=N),theme:"column",placeholder:"请输入账号额度",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:t(()=>[e(f,{label:"过期时间",name:"expireTime"},{default:t(()=>[e(a,{modelValue:n.value.expireTime,"onUpdate:modelValue":v[1]||(v[1]=N=>n.value.expireTime=N),"enable-time-picker":"","allow-input":"",clearable:"",placeholder:"请选择过期时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:t(()=>[e(f,{style:{float:"right"}},{default:t(()=>[e(y,{variant:"outline",onClick:L},{default:t(()=>[b("取消")]),_:1}),e(y,{theme:"primary",type:"submit"},{default:t(()=>[b("确定")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["data","rules","disabled"])]),_:1},8,["visible"])}}}),Je=[{colKey:"row-select",type:"multiple",width:64,fixed:"left"},{colKey:"serial-number",title:"序号",width:80,align:"center",fixed:"left"},{title:"产品包名",colKey:"packageName"},{title:"备注",colKey:"remark"},{fixed:"right",width:180,colKey:"op",title:"操作",align:"center"}],Qe=Q({__name:"DialogForm",props:{visible:{type:Boolean,default:!1},editId:{type:String,default:""},actionType:{type:String,default:""}},emits:["update:visible","update:editId","update:actionType","submit"],setup(U,{emit:R}){const w={packageName:"",menuId:[],remark:""},c=U,B=s({packageName:[{required:!0,message:"请输入产品包名",type:"error",trigger:"blur"}],menuId:[{required:!0,message:"请选择菜单列表",type:"error",trigger:"change"}]}),m=se(()=>`${{view:"查看",edit:"编辑",add:"新增"}[c.actionType]||""}产品包`),n=se(()=>({view:!0,edit:!1})[c.actionType]||!1),r=s(!1),o=s({...w}),g=s(null),p=s(!1),h=R,L=({firstError:u})=>{if(u)$.warning(u);else{p.value=!0;const a={...o.value,menuId:o.value.menuId.join(","),id:c.editId};ze(a).then(()=>{h("submit",a),$.success("提交成功"),r.value=!1}).finally(()=>{p.value=!1})}},V=()=>{o.value={...w},O(()=>{h("update:editId",""),h("update:actionType","")})},v=()=>{r.value=!1};q(()=>r.value,u=>{h("update:visible",u)}),q(()=>c.visible,u=>{u&&c.editId&&O(()=>{we(c.editId).then(a=>{o.value={...a,menuId:a.menuId.split(",")}})}),O(()=>{var a;(a=g.value)==null||a.clearValidate()}),r.value=u});const C=s([]);async function f(){const u=await ke();C.value=u}return ve(()=>{f()}),(u,a)=>{const y=l("t-input"),k=l("t-form-item"),T=l("t-col"),M=l("t-tree-select"),N=l("t-textarea"),D=l("t-button"),A=l("t-row"),P=l("t-form"),I=l("t-dialog");return K(),F(I,{visible:r.value,"onUpdate:visible":a[3]||(a[3]=z=>r.value=z),header:m.value,width:780,footer:!1,onClosed:V},{body:t(()=>[e(P,{ref_key:"form",ref:g,class:fe({"xy-form__detail":U.actionType==="view"}),data:o.value,rules:B.value,"label-width":100,disabled:n.value||p.value,onSubmit:L},{default:t(()=>[e(A,{gutter:[0,28]},{default:t(()=>[e(T,{span:12},{default:t(()=>[e(k,{label:"产品包名",name:"packageName"},{default:t(()=>[e(y,{modelValue:o.value.packageName,"onUpdate:modelValue":a[0]||(a[0]=z=>o.value.packageName=z),placeholder:"请输入产品包名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(T,{span:12},{default:t(()=>[e(k,{label:"菜单列表",name:"menuId"},{default:t(()=>[e(M,{modelValue:o.value.menuId,"onUpdate:modelValue":a[1]||(a[1]=z=>o.value.menuId=z),data:C.value,"tree-props":{keys:{value:"id",label:"title"},valueMode:"all"},multiple:"",clearable:""},null,8,["modelValue","data"])]),_:1})]),_:1}),e(T,{span:12},{default:t(()=>[e(k,{label:"备注",name:"remark"},{default:t(()=>[e(N,{modelValue:o.value.remark,"onUpdate:modelValue":a[2]||(a[2]=z=>o.value.remark=z),placeholder:"请输入备注",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),J(e(T,{span:12},{default:t(()=>[e(k,{style:{float:"right"}},{default:t(()=>[e(D,{variant:"outline",onClick:v},{default:t(()=>[b("取消")]),_:1}),e(D,{theme:"primary",type:"submit"},{default:t(()=>[b("确定")]),_:1})]),_:1})]),_:1},512),[[ye,!n.value]])]),_:1})]),_:1},8,["class","data","rules","disabled"])]),_:1},8,["visible","header"])}}}),We={class:"table-wrapper"},Ye=["onClick"],Ze=["onClick"],Ee=["onClick"],et=Q({__name:"DialogList",props:{visible:{type:Boolean,default:!1},deptId:{type:String,default:""}},emits:["update:visible"],setup(U,{emit:R}){const w=U,c=R,B={packageName:""},m=s([]),n=s(!1),r=s({...B}),o=s(!1),g=s(!1),p=s(""),h=s(""),{fetchData:L,data:V,pagination:v,dataLoading:C}=Ie(Fe,r.value,()=>{m.value=[]}),f=({row:S},x)=>{p.value=S.id,h.value=x,g.value=!0},u=({row:S})=>{D.value=S.id,A.value="one",o.value=!0},a=H(()=>{L()},300),y=S=>{m.value=S},k=S=>{v.value={...v.value,current:S.current||1,pageSize:S.pageSize},a()},M=H(async S=>{try{await Pe(S),o.value=!1,$.success("删除成功"),P(),a()}catch{o.value=!1}},300),N=()=>{m.value.length&&(A.value="check",o.value=!0)},D=s(-1),A=s(),P=()=>{D.value=-1,A.value=""},I=()=>{A.value==="check"&&M(m.value),A.value==="one"&&M([`${D.value}`])},z=()=>{P()};return q(()=>n.value,S=>{c("update:visible",S)}),q(()=>w.visible,S=>{S&&L(),n.value=S}),(S,x)=>{const E=l("t-input"),ee=l("t-form-item"),G=l("t-col"),te=l("t-row"),W=l("t-button"),de=l("t-form"),re=l("t-table"),j=l("t-dialog");return K(),F(j,{visible:n.value,"onUpdate:visible":x[6]||(x[6]=i=>n.value=i),header:"租户产品包管理",width:980,footer:!1},{default:t(()=>[e(de,{ref:"form",data:r.value,"label-width":80,colon:"",style:{marginBottom:"8px"},onReset:_(a),onSubmit:_(a)},{default:t(()=>[e(te,null,{default:t(()=>[e(G,{span:10},{default:t(()=>[e(te,{gutter:[16,24]},{default:t(()=>[e(G,{span:4},{default:t(()=>[e(ee,{label:"产品包名",name:"packageName"},{default:t(()=>[e(E,{modelValue:r.value.packageName,"onUpdate:modelValue":x[0]||(x[0]=i=>r.value.packageName=i),clearable:"",placeholder:"请输入产品包名"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(G,{span:2,class:"operation-wrapper"},{default:t(()=>[e(W,{theme:"primary",type:"submit",style:{marginLeft:"8px"}},{default:t(()=>[b(" 查询 ")]),_:1}),e(W,{type:"reset",variant:"base",theme:"default"},{default:t(()=>[b(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["data","onReset","onSubmit"]),le("div",We,[e(re,{data:_(V),columns:_(Je),hover:!0,loading:_(C),pagination:_(v),"selected-row-keys":m.value,"vertical-align":"top","row-key":"id",bordered:"",stripe:"",onPageChange:k,onSelectChange:y},{"top-content":t(()=>[e(te,{justify:"space-between",style:{"margin-bottom":"10px"}},{default:t(()=>[e(G,{flex:"0 0 auto"},{default:t(()=>[e(W,{onClick:x[1]||(x[1]=i=>f({row:{}},"add"))},{default:t(()=>[b("新增")]),_:1}),e(W,{theme:"danger",onClick:N},{default:t(()=>[b("删除")]),_:1})]),_:1})]),_:1})]),op:t(i=>[le("a",{class:"t-button-link",onClick:Y=>f(i,"view")},"查看",8,Ye),le("a",{class:"t-button-link",onClick:Y=>f(i,"edit")},"编辑",8,Ze),le("a",{class:"t-button-link",onClick:Y=>u(i)},"删除",8,Ee)]),_:1},8,["data","columns","loading","pagination","selected-row-keys"]),e(j,{visible:o.value,"onUpdate:visible":x[2]||(x[2]=i=>o.value=i),header:"确认删除当前所选数据？","on-cancel":z,onConfirm:I},null,8,["visible"]),e(Qe,{visible:g.value,"onUpdate:visible":x[3]||(x[3]=i=>g.value=i),editId:p.value,"onUpdate:editId":x[4]||(x[4]=i=>p.value=i),actionType:h.value,"onUpdate:actionType":x[5]||(x[5]=i=>h.value=i),onSubmit:_(a)},null,8,["visible","editId","actionType","onSubmit"])])]),_:1},8,["visible"])}}}),tt=[{colKey:"row-select",type:"multiple",width:64,fixed:"left"},{colKey:"serial-number",title:"序号",width:80,align:"center",fixed:"left"},{title:"租户ID",colKey:"tenantId"},{title:"租户名称",colKey:"tenantName"},{title:"联系人",colKey:"linkman"},{title:"联系电话",colKey:"contactNumber"},{title:"账号额度",colKey:"accountNumber"},{title:"过期时间",colKey:"expireTime"},{title:"绑定域名",colKey:"domainUrl"},{fixed:"right",width:180,colKey:"op",title:"操作",align:"center"}],at={class:"table-wrapper"},lt=["onClick"],nt=["onClick"],ot=["onClick"],pt=Q({__name:"tenant",setup(U){const{tableVar:R}=je(),{getTableHeaderAffixedTop:w,getLayoutContainer:c}=Be(),{hasRole:B}=Ke(),m={tenantId:"",tenantName:"",linkman:""},n=s([]),r=s({...m}),o=s(!1),g=s(!1),p=s(""),h=s(""),{fetchData:L,data:V,pagination:v,dataLoading:C}=Ie($e,r.value,()=>{n.value=[]});Re(()=>{L()});const f=({row:j},i)=>{p.value=j.id,h.value=i,g.value=!0},u=({row:j})=>{D.value=j.id,A.value="one",o.value=!0},a=H(()=>{L()},300),y=j=>{n.value=j},k=j=>{v.value={...v.value,current:j.current||1,pageSize:j.pageSize},a()},M=H(async j=>{try{await Ae(j),o.value=!1,$.success("删除成功"),P(),a()}catch{o.value=!1}},300),N=()=>{n.value.length&&(A.value="check",o.value=!0)},D=s(-1),A=s(),P=()=>{D.value=-1,A.value=""},I=()=>{A.value==="check"&&M(n.value),A.value==="one"&&M([`${D.value}`])},z=()=>{P()},S=s(!1),x=s(!1),E=s(!1),ee=s(!1),G=s(""),te=H(()=>{if(!n.value.length){$.error("至少选择一条数据");return}p.value=n.value.join(","),S.value=!0},300),W=H(()=>{if(!n.value.length){$.error("至少选择一条数据");return}if(n.value.length!==1){$.error("只能选择一条数据");return}p.value=n.value.join(","),x.value=!0},300),de=H(()=>{if(!n.value.length){$.error("至少选择一条数据");return}if(n.value.length!==1){$.error("只能选择一条数据");return}p.value=n.value.join(",");const j=V.value.find(i=>i.id===p.value);G.value=j.tenantId,E.value=!0},300),re=H(()=>{ee.value=!0},300);return(j,i)=>{const Y=l("t-input"),ce=l("t-form-item"),Z=l("t-col"),me=l("t-row"),X=l("t-button"),he=l("t-form"),oe=l("t-tooltip"),_e=l("t-tag"),Ve=l("t-table"),Ce=l("t-dialog"),ae=Le("auth");return K(),ue("div",{class:fe(_(R))},[e(he,{ref:"form",data:r.value,"label-width":80,colon:"",style:{marginBottom:"8px"},onReset:_(a),onSubmit:_(a)},{default:t(()=>[e(me,null,{default:t(()=>[e(Z,{span:10},{default:t(()=>[e(me,{gutter:[16,24]},{default:t(()=>[e(Z,{span:4},{default:t(()=>[e(ce,{label:"租户ID",name:"tenantId"},{default:t(()=>[e(Y,{modelValue:r.value.tenantId,"onUpdate:modelValue":i[0]||(i[0]=d=>r.value.tenantId=d),clearable:"",placeholder:"请输入租户ID"},null,8,["modelValue"])]),_:1})]),_:1}),e(Z,{span:4},{default:t(()=>[e(ce,{label:"租户名称",name:"tenantName"},{default:t(()=>[e(Y,{modelValue:r.value.tenantName,"onUpdate:modelValue":i[1]||(i[1]=d=>r.value.tenantName=d),clearable:"",placeholder:"请输入租户名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(Z,{span:4},{default:t(()=>[e(ce,{label:"联系人",name:"linkman"},{default:t(()=>[e(Y,{modelValue:r.value.linkman,"onUpdate:modelValue":i[2]||(i[2]=d=>r.value.linkman=d),clearable:"",placeholder:"请输入联系人"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Z,{span:2,class:"operation-wrapper"},{default:t(()=>[e(X,{theme:"primary",type:"submit",style:{marginLeft:"8px"}},{default:t(()=>[b(" 查询 ")]),_:1}),e(X,{type:"reset",variant:"base",theme:"default"},{default:t(()=>[b(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["data","onReset","onSubmit"]),le("div",at,[e(Ve,{data:_(V),columns:_(tt),hover:!0,loading:_(C),pagination:_(v),"selected-row-keys":n.value,"header-affixed-top":{offsetTop:_(w),container:_(c)},"vertical-align":"top","row-key":"id",bordered:"",stripe:"",onPageChange:k,onSelectChange:y},{"top-content":t(()=>[e(me,{justify:"space-between",style:{"margin-bottom":"10px"}},{default:t(()=>[e(Z,{flex:"0 0 auto"},{default:t(()=>[J((K(),F(X,{onClick:i[3]||(i[3]=d=>f({row:{}},"add"))},{default:t(()=>[b("新增")]),_:1})),[[ae,"tenant_add"]]),J((K(),F(X,{theme:"danger",onClick:N},{default:t(()=>[b("删除")]),_:1})),[[ae,"tenant_delete"]]),_(B)("administrator")?(K(),F(oe,{key:0,content:"给租户配置账号额度、过期时间等授权信息",placement:"top","show-arrow":""},{default:t(()=>[e(X,{variant:"outline",onClick:_(te)},{default:t(()=>[b("授权配置")]),_:1},8,["onClick"])]),_:1})):ie("",!0),_(B)("administrator")?(K(),F(oe,{key:1,content:"给租户配置独立数据源以实现数据库隔离",placement:"top","show-arrow":""},{default:t(()=>[e(X,{variant:"outline",onClick:_(W)},{default:t(()=>[b("数据源配置")]),_:1},8,["onClick"])]),_:1})):ie("",!0),_(B)("administrator")?(K(),F(oe,{key:2,content:"将菜单产品包与租户配置绑定",placement:"top","show-arrow":""},{default:t(()=>[e(X,{variant:"outline",onClick:_(de)},{default:t(()=>[b("产品包配置")]),_:1},8,["onClick"])]),_:1})):ie("",!0),_(B)("administrator")?(K(),F(oe,{key:3,content:"将自定义的菜单集合定制为租户绑定的菜单产品包",placement:"top","show-arrow":""},{default:t(()=>[e(X,{variant:"outline",onClick:_(re)},{default:t(()=>[b("产品包管理")]),_:1},8,["onClick"])]),_:1})):ie("",!0)]),_:1})]),_:1})]),accountNumber:t(({row:d})=>[e(_e,{theme:"primary",variant:"light"},{default:t(()=>[b(ge(d.accountNumber>0?d.accountNumber:"不限制"),1)]),_:2},1024)]),expireTime:t(({row:d})=>[e(_e,{theme:"primary",variant:"light"},{default:t(()=>[b(ge(d.expireTime?d.expireTime:"不限制"),1)]),_:2},1024)]),op:t(d=>[J((K(),ue("a",{class:"t-button-link",onClick:be=>f(d,"view")},[b("查看")],8,lt)),[[ae,"tenant_view"]]),J((K(),ue("a",{class:"t-button-link",onClick:be=>f(d,"edit")},[b("编辑")],8,nt)),[[ae,"tenant_edit"]]),J((K(),ue("a",{class:"t-button-link",onClick:be=>u(d)},[b("删除")],8,ot)),[[ae,"tenant_delete"]])]),_:1},8,["data","columns","loading","pagination","selected-row-keys","header-affixed-top"]),e(Ce,{visible:o.value,"onUpdate:visible":i[4]||(i[4]=d=>o.value=d),header:"确认删除当前所选数据？","on-cancel":z,onConfirm:I},null,8,["visible"]),e(qe,{visible:g.value,"onUpdate:visible":i[5]||(i[5]=d=>g.value=d),editId:p.value,"onUpdate:editId":i[6]||(i[6]=d=>p.value=d),actionType:h.value,"onUpdate:actionType":i[7]||(i[7]=d=>h.value=d),onSubmit:_(a)},null,8,["visible","editId","actionType","onSubmit"]),e(Ge,{visible:S.value,"onUpdate:visible":i[8]||(i[8]=d=>S.value=d),editId:p.value,"onUpdate:editId":i[9]||(i[9]=d=>p.value=d),onSubmit:_(a)},null,8,["visible","editId","onSubmit"]),e(Oe,{visible:x.value,"onUpdate:visible":i[10]||(i[10]=d=>x.value=d),editId:p.value,"onUpdate:editId":i[11]||(i[11]=d=>p.value=d),onSubmit:_(a)},null,8,["visible","editId","onSubmit"]),e(He,{visible:E.value,"onUpdate:visible":i[12]||(i[12]=d=>E.value=d),editId:p.value,"onUpdate:editId":i[13]||(i[13]=d=>p.value=d),"tenant-id":G.value,onSubmit:_(a)},null,8,["visible","editId","tenant-id","onSubmit"]),e(et,{visible:ee.value,"onUpdate:visible":i[14]||(i[14]=d=>ee.value=d)},null,8,["visible"])])],2)}}});export{pt as default};
