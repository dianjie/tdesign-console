import{a as ce,d as Te,b as Se,s as xe,p as Ne,c as De,e as he,f as $e,r as Ae}from"./tenant-BajJal67.js";import{u as Be}from"./useSetting-CnYQd1RY.js";import{u as Ke}from"./useDesign-CbWcZHFZ.js";import{d as X,f as s,a2 as q,Q as O,ad as ve,r as n,o as R,m as F,w as t,a as e,q as g,M as $,J as se,s as fe,W,X as ye,an as ne,a_ as ke,b as _,e as le,aw as Re,i as je,as as Le,c as ue,p as ie,t as ge}from"./index-CqGaQ7t4.js";import{u as Ie}from"./useRequset-Bj5fiv5N.js";import{u as Me}from"./oss-2LbzLkrS.js";import{u as J}from"./index-BidCcHov.js";const Oe=X({__name:"DialogDatasource",props:{visible:{type:Boolean,default:!1},editId:{type:String,default:""}},emits:["update:visible","update:editId","submit"],setup(S,{emit:j}){const V={datasourceId:"",tenantId:""},p=S,B=s({datasourceId:[{required:!0,message:"请选择数据源",type:"error",trigger:"change"}]}),c=s(!1),o=s({...V}),r=s(null),u=s(!1),y=j,v=({firstError:T})=>{T?$.warning(T):(u.value=!0,Te(o.value.tenantId,o.value.datasourceId).then(()=>{y("submit",{}),$.success("提交成功"),c.value=!1}).finally(()=>{u.value=!1}))},C=()=>{o.value={...V},O(()=>{y("update:editId","")})},L=()=>{c.value=!1};q(()=>c.value,T=>{y("update:visible",T)}),q(()=>p.visible,T=>{T&&p.editId&&O(()=>{p.editId.split(",").length===1?ce(p.editId).then(f=>{o.value={datasourceId:f.datasourceId,tenantId:f.tenantId}}):o.value={...V}}),O(()=>{var f;(f=r.value)==null||f.clearValidate()}),c.value=T});const U=s([]);async function m(){const T=await Se();U.value=T}return ve(()=>{m()}),(T,f)=>{const i=n("t-select"),a=n("t-form-item"),k=n("t-col"),I=n("t-button"),x=n("t-row"),M=n("t-form"),D=n("t-dialog");return R(),F(D,{visible:c.value,"onUpdate:visible":f[1]||(f[1]=h=>c.value=h),header:"租户数据源配置",width:480,footer:!1,onClosed:C},{body:t(()=>[e(M,{ref_key:"form",ref:r,data:o.value,rules:B.value,"label-width":100,disabled:u.value,onSubmit:v},{default:t(()=>[e(x,{gutter:[0,28]},{default:t(()=>[e(k,{span:12},{default:t(()=>[e(a,{label:"数据源",name:"datasourceId"},{default:t(()=>[e(i,{modelValue:o.value.datasourceId,"onUpdate:modelValue":f[0]||(f[0]=h=>o.value.datasourceId=h),options:U.value,keys:{value:"id",label:"name"},clearable:"",placeholder:"请选择数据源"},null,8,["modelValue","options"])]),_:1})]),_:1}),e(k,{span:12},{default:t(()=>[e(a,{style:{float:"right"}},{default:t(()=>[e(I,{variant:"outline",onClick:L},{default:t(()=>f[2]||(f[2]=[g("取消")])),_:1}),e(I,{theme:"primary",type:"submit"},{default:t(()=>f[3]||(f[3]=[g("确定")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["data","rules","disabled"])]),_:1},8,["visible"])}}}),qe=X({__name:"DialogForm",props:{visible:{type:Boolean,default:!1},editId:{type:String,default:""},actionType:{type:String,default:""}},emits:["update:visible","update:editId","update:actionType","submit"],setup(S,{emit:j}){const V={tenantName:"",linkman:"",contactNumber:"",address:"",domainUrl:"",backgroundUrl:[]},p=S,B=s({tenantName:[{required:!0,message:"请输入租户名称",type:"error",trigger:"blur"}],linkman:[{required:!0,message:"请输入联系人",type:"error",trigger:"blur"}]}),c=se(()=>`${{view:"查看",edit:"编辑",add:"新增"}[p.actionType]||""}租户`),o=se(()=>({view:!0,edit:!1})[p.actionType]||!1),r=s(!1),u=s({...V}),y=s(null),v=s(!1),C=j,L=({firstError:i})=>{var a;if(i)$.warning(i);else{v.value=!0;const k={...u.value,backgroundUrl:u.value.backgroundUrl.length?(a=u.value.backgroundUrl[0])==null?void 0:a.url:"",id:p.editId};xe(k).then(()=>{C("submit",k),$.success("提交成功"),r.value=!1}).finally(()=>{v.value=!1})}},U=()=>{u.value={...V},O(()=>{C("update:editId",""),C("update:actionType","")})},m=()=>{r.value=!1};q(()=>r.value,i=>{C("update:visible",i)}),q(()=>p.visible,i=>{i&&p.editId&&O(()=>{ce(p.editId).then(a=>{u.value={...a,backgroundUrl:a.backgroundUrl?[{url:a.backgroundUrl}]:[]}})}),O(()=>{var a;(a=y.value)==null||a.clearValidate()}),r.value=i});const T=({file:i})=>{$.error(`文件 ${i.name} 上传失败`)},f=async i=>{try{const a=await Me({file:i.raw});return{status:"success",response:{...a,url:a.link}}}catch{return{status:"fail",error:"上传失败"}}};return(i,a)=>{const k=n("t-input"),I=n("t-form-item"),x=n("t-col"),M=n("t-upload"),D=n("t-button"),h=n("t-row"),A=n("t-form"),P=n("t-dialog");return R(),F(P,{visible:r.value,"onUpdate:visible":a[6]||(a[6]=w=>r.value=w),header:c.value,width:780,footer:!1,onClosed:U},{body:t(()=>[e(A,{ref_key:"form",ref:y,class:fe({"xy-form__detail":S.actionType==="view"}),data:u.value,rules:B.value,"label-width":100,disabled:o.value||v.value,onSubmit:L},{default:t(()=>[e(h,{gutter:[0,28]},{default:t(()=>[e(x,{span:12},{default:t(()=>[e(I,{label:"租户名称",name:"tenantName"},{default:t(()=>[e(k,{modelValue:u.value.tenantName,"onUpdate:modelValue":a[0]||(a[0]=w=>u.value.tenantName=w),placeholder:"请输入租户名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(x,{span:6},{default:t(()=>[e(I,{label:"联系人",name:"linkman"},{default:t(()=>[e(k,{modelValue:u.value.linkman,"onUpdate:modelValue":a[1]||(a[1]=w=>u.value.linkman=w),placeholder:"请输入联系人",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(x,{span:6},{default:t(()=>[e(I,{label:"联系电话",name:"contactNumber"},{default:t(()=>[e(k,{modelValue:u.value.contactNumber,"onUpdate:modelValue":a[2]||(a[2]=w=>u.value.contactNumber=w),placeholder:"请输入联系电话",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(x,{span:12},{default:t(()=>[e(I,{label:"联系地址",name:"address"},{default:t(()=>[e(k,{modelValue:u.value.address,"onUpdate:modelValue":a[3]||(a[3]=w=>u.value.address=w),theme:"column",placeholder:"请输入联系地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(x,{span:12},{default:t(()=>[e(I,{label:"绑定域名",name:"domainUrl"},{default:t(()=>[e(k,{modelValue:u.value.domainUrl,"onUpdate:modelValue":a[4]||(a[4]=w=>u.value.domainUrl=w),theme:"column",placeholder:"请输入绑定域名",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(x,{span:12},{default:t(()=>[e(I,{label:"背景图片",name:"backgroundUrl"},{default:t(()=>[e(M,{ref:"uploadRef",modelValue:u.value.backgroundUrl,"onUpdate:modelValue":a[5]||(a[5]=w=>u.value.backgroundUrl=w),theme:"image",tips:"单张图片文件上传",accept:"image/*",locale:{triggerUploadText:{image:"请选择图片"}},"request-method":f,disabled:o.value||v.value,onFail:T},null,8,["modelValue","disabled"])]),_:1})]),_:1}),W(e(x,{span:12},{default:t(()=>[e(I,{style:{float:"right"}},{default:t(()=>[e(D,{variant:"outline",onClick:m},{default:t(()=>a[7]||(a[7]=[g("取消")])),_:1}),e(D,{theme:"primary",type:"submit"},{default:t(()=>a[8]||(a[8]=[g("确定")])),_:1})]),_:1})]),_:1},512),[[ye,!o.value]])]),_:1})]),_:1},8,["class","data","rules","disabled"])]),_:1},8,["visible","header"])}}}),Fe=(S,j,V)=>ne.get({url:"/blade-system/tenant-package/list",params:{...V,current:S,size:j}}),we=S=>ne.get({url:"/blade-system/tenant-package/detail",params:{id:S}}),Pe=S=>ne.post({url:"/blade-system/tenant-package/remove",params:{ids:S}},{joinParamsToUrl:!0,errorMessageMode:"message"}),ze=S=>ne.post({url:"/blade-system/tenant-package/submit",data:S}),He=()=>ne.get({url:"/blade-system/tenant-package/select"}),Je=X({__name:"DialogPackage",props:{visible:{type:Boolean,default:!1},editId:{type:String,default:""},tenantId:{type:String,default:""}},emits:["update:visible","update:editId","submit"],setup(S,{emit:j}){const V={packageId:"",menuId:[]},p=S,B=s({}),c=s(!1),o=s({...V}),r=s(null),u=s(!1),y=j,v=({firstError:i})=>{i?$.warning(i):(u.value=!0,De(p.tenantId,o.value.packageId).then(()=>{y("submit",{}),$.success("提交成功"),c.value=!1}).finally(()=>{u.value=!1}))},C=()=>{o.value={...V},O(()=>{y("update:editId","")})},L=()=>{c.value=!1},U=s([]),m=s([]);async function T(){const i=await ke();U.value=i}function f(){He().then(i=>{m.value=i})}return ve(()=>{T()}),q(()=>c.value,i=>{y("update:visible",i)}),q(()=>p.visible,i=>{i&&f(),i&&p.editId&&O(()=>{p.editId.split(",").length===1?Ne(p.editId).then(a=>{var k;o.value={packageId:a.id,menuId:((k=a.menuId)==null?void 0:k.split(","))||[]}}):o.value={...V}}),O(()=>{var a;(a=r.value)==null||a.clearValidate()}),c.value=i}),q(()=>o.value.packageId,i=>{i?we(i).then(a=>{o.value.menuId=a.menuId.split(",")}):o.value={...V}}),(i,a)=>{const k=n("t-select"),I=n("t-form-item"),x=n("t-col"),M=n("t-tree-select"),D=n("t-button"),h=n("t-row"),A=n("t-form"),P=n("t-dialog");return R(),F(P,{visible:c.value,"onUpdate:visible":a[2]||(a[2]=w=>c.value=w),header:"租户产品包配置",width:480,footer:!1,onClosed:C},{body:t(()=>[e(A,{ref_key:"form",ref:r,data:o.value,rules:B.value,"label-width":100,disabled:u.value,onSubmit:v},{default:t(()=>[e(h,{gutter:[0,28]},{default:t(()=>[e(x,{span:12},{default:t(()=>[e(I,{label:"产品包",name:"packageId"},{default:t(()=>[e(k,{modelValue:o.value.packageId,"onUpdate:modelValue":a[0]||(a[0]=w=>o.value.packageId=w),options:m.value,keys:{value:"id",label:"packageName"},clearable:"",placeholder:"请选择产品包"},null,8,["modelValue","options"])]),_:1})]),_:1}),e(x,{span:12},{default:t(()=>[e(I,{label:"菜单预览",name:"menuId"},{default:t(()=>[e(M,{modelValue:o.value.menuId,"onUpdate:modelValue":a[1]||(a[1]=w=>o.value.menuId=w),data:U.value,"tree-props":{keys:{value:"id",label:"title"},valueMode:"all"},multiple:"",clearable:""},null,8,["modelValue","data"])]),_:1})]),_:1}),e(x,{span:12},{default:t(()=>[e(I,{style:{float:"right"}},{default:t(()=>[e(D,{variant:"outline",onClick:L},{default:t(()=>a[3]||(a[3]=[g("取消")])),_:1}),e(D,{theme:"primary",type:"submit"},{default:t(()=>a[4]||(a[4]=[g("确定")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["data","rules","disabled"])]),_:1},8,["visible"])}}}),Qe=X({__name:"DialogSetting",props:{visible:{type:Boolean,default:!1},editId:{type:String,default:""}},emits:["update:visible","update:editId","submit"],setup(S,{emit:j}){const V={accountNumber:-1,expireTime:""},p=S,B=s({}),c=s(!1),o=s({...V}),r=s(null),u=s(!1),y=j,v=({firstError:U})=>{if(U)$.warning(U);else{u.value=!0;const m={...o.value,ids:p.editId};he(m).then(()=>{y("submit",m),$.success("提交成功"),c.value=!1}).finally(()=>{u.value=!1})}},C=()=>{o.value={...V},O(()=>{y("update:editId","")})},L=()=>{c.value=!1};return q(()=>c.value,U=>{y("update:visible",U)}),q(()=>p.visible,U=>{U&&p.editId&&O(()=>{p.editId.split(",").length===1?ce(p.editId).then(m=>{o.value={accountNumber:m.accountNumber,expireTime:m.expireTime}}):o.value={...V}}),O(()=>{var m;(m=r.value)==null||m.clearValidate()}),c.value=U}),(U,m)=>{const T=n("t-input-number"),f=n("t-form-item"),i=n("t-col"),a=n("t-date-picker"),k=n("t-button"),I=n("t-row"),x=n("t-form"),M=n("t-dialog");return R(),F(M,{visible:c.value,"onUpdate:visible":m[2]||(m[2]=D=>c.value=D),header:"租户授权配置",width:480,footer:!1,onClosed:C},{body:t(()=>[e(x,{ref_key:"form",ref:r,data:o.value,rules:B.value,"label-width":100,disabled:u.value,onSubmit:v},{default:t(()=>[e(I,{gutter:[0,28]},{default:t(()=>[e(i,{span:12},{default:t(()=>[e(f,{label:"账号额度",name:"accountNumber"},{default:t(()=>[e(T,{modelValue:o.value.accountNumber,"onUpdate:modelValue":m[0]||(m[0]=D=>o.value.accountNumber=D),theme:"column",placeholder:"请输入账号额度",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:t(()=>[e(f,{label:"过期时间",name:"expireTime"},{default:t(()=>[e(a,{modelValue:o.value.expireTime,"onUpdate:modelValue":m[1]||(m[1]=D=>o.value.expireTime=D),"enable-time-picker":"","allow-input":"",clearable:"",placeholder:"请选择过期时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:t(()=>[e(f,{style:{float:"right"}},{default:t(()=>[e(k,{variant:"outline",onClick:L},{default:t(()=>m[3]||(m[3]=[g("取消")])),_:1}),e(k,{theme:"primary",type:"submit"},{default:t(()=>m[4]||(m[4]=[g("确定")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["data","rules","disabled"])]),_:1},8,["visible"])}}}),We=[{colKey:"row-select",type:"multiple",width:64,fixed:"left"},{colKey:"serial-number",title:"序号",width:80,align:"center",fixed:"left"},{title:"产品包名",colKey:"packageName"},{title:"备注",colKey:"remark"},{fixed:"right",width:180,colKey:"op",title:"操作",align:"center"}],Xe=X({__name:"DialogForm",props:{visible:{type:Boolean,default:!1},editId:{type:String,default:""},actionType:{type:String,default:""}},emits:["update:visible","update:editId","update:actionType","submit"],setup(S,{emit:j}){const V={packageName:"",menuId:[],remark:""},p=S,B=s({packageName:[{required:!0,message:"请输入产品包名",type:"error",trigger:"blur"}],menuId:[{required:!0,message:"请选择菜单列表",type:"error",trigger:"change"}]}),c=se(()=>`${{view:"查看",edit:"编辑",add:"新增"}[p.actionType]||""}产品包`),o=se(()=>({view:!0,edit:!1})[p.actionType]||!1),r=s(!1),u=s({...V}),y=s(null),v=s(!1),C=j,L=({firstError:i})=>{if(i)$.warning(i);else{v.value=!0;const a={...u.value,menuId:u.value.menuId.join(","),id:p.editId};ze(a).then(()=>{C("submit",a),$.success("提交成功"),r.value=!1}).finally(()=>{v.value=!1})}},U=()=>{u.value={...V},O(()=>{C("update:editId",""),C("update:actionType","")})},m=()=>{r.value=!1};q(()=>r.value,i=>{C("update:visible",i)}),q(()=>p.visible,i=>{i&&p.editId&&O(()=>{we(p.editId).then(a=>{u.value={...a,menuId:a.menuId.split(",")}})}),O(()=>{var a;(a=y.value)==null||a.clearValidate()}),r.value=i});const T=s([]);async function f(){const i=await ke();T.value=i}return ve(()=>{f()}),(i,a)=>{const k=n("t-input"),I=n("t-form-item"),x=n("t-col"),M=n("t-tree-select"),D=n("t-textarea"),h=n("t-button"),A=n("t-row"),P=n("t-form"),w=n("t-dialog");return R(),F(w,{visible:r.value,"onUpdate:visible":a[3]||(a[3]=z=>r.value=z),header:c.value,width:780,footer:!1,onClosed:U},{body:t(()=>[e(P,{ref_key:"form",ref:y,class:fe({"xy-form__detail":S.actionType==="view"}),data:u.value,rules:B.value,"label-width":100,disabled:o.value||v.value,onSubmit:L},{default:t(()=>[e(A,{gutter:[0,28]},{default:t(()=>[e(x,{span:12},{default:t(()=>[e(I,{label:"产品包名",name:"packageName"},{default:t(()=>[e(k,{modelValue:u.value.packageName,"onUpdate:modelValue":a[0]||(a[0]=z=>u.value.packageName=z),placeholder:"请输入产品包名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(x,{span:12},{default:t(()=>[e(I,{label:"菜单列表",name:"menuId"},{default:t(()=>[e(M,{modelValue:u.value.menuId,"onUpdate:modelValue":a[1]||(a[1]=z=>u.value.menuId=z),data:T.value,"tree-props":{keys:{value:"id",label:"title"},valueMode:"all"},multiple:"",clearable:""},null,8,["modelValue","data"])]),_:1})]),_:1}),e(x,{span:12},{default:t(()=>[e(I,{label:"备注",name:"remark"},{default:t(()=>[e(D,{modelValue:u.value.remark,"onUpdate:modelValue":a[2]||(a[2]=z=>u.value.remark=z),placeholder:"请输入备注",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),W(e(x,{span:12},{default:t(()=>[e(I,{style:{float:"right"}},{default:t(()=>[e(h,{variant:"outline",onClick:m},{default:t(()=>a[4]||(a[4]=[g("取消")])),_:1}),e(h,{theme:"primary",type:"submit"},{default:t(()=>a[5]||(a[5]=[g("确定")])),_:1})]),_:1})]),_:1},512),[[ye,!o.value]])]),_:1})]),_:1},8,["class","data","rules","disabled"])]),_:1},8,["visible","header"])}}}),Ge={class:"table-wrapper"},Ye=["onClick"],Ze=["onClick"],Ee=["onClick"],et=X({__name:"DialogList",props:{visible:{type:Boolean,default:!1},deptId:{type:String,default:""}},emits:["update:visible"],setup(S,{emit:j}){const V=S,p=j,B={packageName:""},c=s([]),o=s(!1),r=s({...B}),u=s(!1),y=s(!1),v=s(""),C=s(""),{fetchData:L,data:U,pagination:m,dataLoading:T}=Ie(Fe,r.value,()=>{c.value=[]}),f=({row:N},b)=>{v.value=N.id,C.value=b,y.value=!0},i=({row:N})=>{h.value=N.id,A.value="one",u.value=!0},a=J(()=>{L()},300),k=N=>{c.value=N},I=N=>{m.value={...m.value,current:N.current||1,pageSize:N.pageSize},a()},M=J(async N=>{try{await Pe(N),u.value=!1,$.success("删除成功"),P(),a()}catch{u.value=!1}},300),D=()=>{c.value.length&&(A.value="check",u.value=!0)},h=s(-1),A=s(),P=()=>{h.value=-1,A.value=""},w=()=>{A.value==="check"&&M(c.value),A.value==="one"&&M([`${h.value}`])},z=()=>{P()};return q(()=>o.value,N=>{p("update:visible",N)}),q(()=>V.visible,N=>{N&&L(),o.value=N}),(N,b)=>{const E=n("t-input"),ee=n("t-form-item"),Q=n("t-col"),te=n("t-row"),G=n("t-button"),de=n("t-form"),re=n("t-table"),K=n("t-dialog");return R(),F(K,{visible:o.value,"onUpdate:visible":b[6]||(b[6]=l=>o.value=l),header:"租户产品包管理",width:980,footer:!1},{default:t(()=>[e(de,{ref:"form",data:r.value,"label-width":80,colon:"",style:{marginBottom:"8px"},onReset:_(a),onSubmit:_(a)},{default:t(()=>[e(te,null,{default:t(()=>[e(Q,{span:10},{default:t(()=>[e(te,{gutter:[16,24]},{default:t(()=>[e(Q,{span:4},{default:t(()=>[e(ee,{label:"产品包名",name:"packageName"},{default:t(()=>[e(E,{modelValue:r.value.packageName,"onUpdate:modelValue":b[0]||(b[0]=l=>r.value.packageName=l),clearable:"",placeholder:"请输入产品包名"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Q,{span:2,class:"operation-wrapper"},{default:t(()=>[e(G,{theme:"primary",type:"submit",style:{marginLeft:"8px"}},{default:t(()=>b[7]||(b[7]=[g(" 查询 ")])),_:1}),e(G,{type:"reset",variant:"base",theme:"default"},{default:t(()=>b[8]||(b[8]=[g(" 重置 ")])),_:1})]),_:1})]),_:1})]),_:1},8,["data","onReset","onSubmit"]),le("div",Ge,[e(re,{data:_(U),columns:_(We),hover:!0,loading:_(T),pagination:_(m),"selected-row-keys":c.value,"vertical-align":"top","row-key":"id",bordered:"",stripe:"",onPageChange:I,onSelectChange:k},{"top-content":t(()=>[e(te,{justify:"space-between",style:{"margin-bottom":"10px"}},{default:t(()=>[e(Q,{flex:"0 0 auto"},{default:t(()=>[e(G,{onClick:b[1]||(b[1]=l=>f({row:{}},"add"))},{default:t(()=>b[9]||(b[9]=[g("新增")])),_:1}),e(G,{theme:"danger",onClick:D},{default:t(()=>b[10]||(b[10]=[g("删除")])),_:1})]),_:1})]),_:1})]),op:t(l=>[le("a",{class:"t-button-link",onClick:Y=>f(l,"view")},"查看",8,Ye),le("a",{class:"t-button-link",onClick:Y=>f(l,"edit")},"编辑",8,Ze),le("a",{class:"t-button-link",onClick:Y=>i(l)},"删除",8,Ee)]),_:1},8,["data","columns","loading","pagination","selected-row-keys"]),e(K,{visible:u.value,"onUpdate:visible":b[2]||(b[2]=l=>u.value=l),header:"确认删除当前所选数据？","on-cancel":z,onConfirm:w},null,8,["visible"]),e(Xe,{visible:y.value,"onUpdate:visible":b[3]||(b[3]=l=>y.value=l),editId:v.value,"onUpdate:editId":b[4]||(b[4]=l=>v.value=l),actionType:C.value,"onUpdate:actionType":b[5]||(b[5]=l=>C.value=l),onSubmit:_(a)},null,8,["visible","editId","actionType","onSubmit"])])]),_:1},8,["visible"])}}}),tt=[{colKey:"row-select",type:"multiple",width:64,fixed:"left"},{colKey:"serial-number",title:"序号",width:80,align:"center",fixed:"left"},{title:"租户ID",colKey:"tenantId"},{title:"租户名称",colKey:"tenantName"},{title:"联系人",colKey:"linkman"},{title:"联系电话",colKey:"contactNumber"},{title:"账号额度",colKey:"accountNumber"},{title:"过期时间",colKey:"expireTime"},{title:"绑定域名",colKey:"domainUrl"},{fixed:"right",width:180,colKey:"op",title:"操作",align:"center"}],at={class:"table-wrapper"},lt=["onClick"],nt=["onClick"],ot=["onClick"],ct=X({__name:"tenant",setup(S){const{tableVar:j}=Ke(),{getTableHeaderAffixedTop:V,getLayoutContainer:p}=Be(),{hasRole:B}=Re(),c={tenantId:"",tenantName:"",linkman:""},o=s([]),r=s({...c}),u=s(!1),y=s(!1),v=s(""),C=s(""),{fetchData:L,data:U,pagination:m,dataLoading:T}=Ie($e,r.value,()=>{o.value=[]});je(()=>{L()});const f=({row:K},l)=>{v.value=K.id,C.value=l,y.value=!0},i=({row:K})=>{h.value=K.id,A.value="one",u.value=!0},a=J(()=>{L()},300),k=K=>{o.value=K},I=K=>{m.value={...m.value,current:K.current||1,pageSize:K.pageSize},a()},M=J(async K=>{try{await Ae(K),u.value=!1,$.success("删除成功"),P(),a()}catch{u.value=!1}},300),D=()=>{o.value.length&&(A.value="check",u.value=!0)},h=s(-1),A=s(),P=()=>{h.value=-1,A.value=""},w=()=>{A.value==="check"&&M(o.value),A.value==="one"&&M([`${h.value}`])},z=()=>{P()},N=s(!1),b=s(!1),E=s(!1),ee=s(!1),Q=s(""),te=J(()=>{if(!o.value.length){$.error("至少选择一条数据");return}v.value=o.value.join(","),N.value=!0},300),G=J(()=>{if(!o.value.length){$.error("至少选择一条数据");return}if(o.value.length!==1){$.error("只能选择一条数据");return}v.value=o.value.join(","),b.value=!0},300),de=J(()=>{if(!o.value.length){$.error("至少选择一条数据");return}if(o.value.length!==1){$.error("只能选择一条数据");return}v.value=o.value.join(",");const K=U.value.find(l=>l.id===v.value);Q.value=K.tenantId,E.value=!0},300),re=J(()=>{ee.value=!0},300);return(K,l)=>{const Y=n("t-input"),me=n("t-form-item"),Z=n("t-col"),pe=n("t-row"),H=n("t-button"),Ve=n("t-form"),oe=n("t-tooltip"),be=n("t-tag"),Ce=n("t-table"),Ue=n("t-dialog"),ae=Le("auth");return R(),ue("div",{class:fe(_(j))},[e(Ve,{ref:"form",data:r.value,"label-width":80,colon:"",style:{marginBottom:"8px"},onReset:_(a),onSubmit:_(a)},{default:t(()=>[e(pe,null,{default:t(()=>[e(Z,{span:10},{default:t(()=>[e(pe,{gutter:[16,24]},{default:t(()=>[e(Z,{span:4},{default:t(()=>[e(me,{label:"租户ID",name:"tenantId"},{default:t(()=>[e(Y,{modelValue:r.value.tenantId,"onUpdate:modelValue":l[0]||(l[0]=d=>r.value.tenantId=d),clearable:"",placeholder:"请输入租户ID"},null,8,["modelValue"])]),_:1})]),_:1}),e(Z,{span:4},{default:t(()=>[e(me,{label:"租户名称",name:"tenantName"},{default:t(()=>[e(Y,{modelValue:r.value.tenantName,"onUpdate:modelValue":l[1]||(l[1]=d=>r.value.tenantName=d),clearable:"",placeholder:"请输入租户名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(Z,{span:4},{default:t(()=>[e(me,{label:"联系人",name:"linkman"},{default:t(()=>[e(Y,{modelValue:r.value.linkman,"onUpdate:modelValue":l[2]||(l[2]=d=>r.value.linkman=d),clearable:"",placeholder:"请输入联系人"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Z,{span:2,class:"operation-wrapper"},{default:t(()=>[e(H,{theme:"primary",type:"submit",style:{marginLeft:"8px"}},{default:t(()=>l[15]||(l[15]=[g(" 查询 ")])),_:1}),e(H,{type:"reset",variant:"base",theme:"default"},{default:t(()=>l[16]||(l[16]=[g(" 重置 ")])),_:1})]),_:1})]),_:1})]),_:1},8,["data","onReset","onSubmit"]),le("div",at,[e(Ce,{data:_(U),columns:_(tt),hover:!0,loading:_(T),pagination:_(m),"selected-row-keys":o.value,"header-affixed-top":{offsetTop:_(V),container:_(p)},"vertical-align":"top","row-key":"id",bordered:"",stripe:"",onPageChange:I,onSelectChange:k},{"top-content":t(()=>[e(pe,{justify:"space-between",style:{"margin-bottom":"10px"}},{default:t(()=>[e(Z,{flex:"0 0 auto"},{default:t(()=>[W((R(),F(H,{onClick:l[3]||(l[3]=d=>f({row:{}},"add"))},{default:t(()=>l[17]||(l[17]=[g("新增")])),_:1})),[[ae,"tenant_add"]]),W((R(),F(H,{theme:"danger",onClick:D},{default:t(()=>l[18]||(l[18]=[g("删除")])),_:1})),[[ae,"tenant_delete"]]),_(B)("administrator")?(R(),F(oe,{key:0,content:"给租户配置账号额度、过期时间等授权信息",placement:"top","show-arrow":""},{default:t(()=>[e(H,{variant:"outline",onClick:_(te)},{default:t(()=>l[19]||(l[19]=[g("授权配置")])),_:1},8,["onClick"])]),_:1})):ie("",!0),_(B)("administrator")?(R(),F(oe,{key:1,content:"给租户配置独立数据源以实现数据库隔离",placement:"top","show-arrow":""},{default:t(()=>[e(H,{variant:"outline",onClick:_(G)},{default:t(()=>l[20]||(l[20]=[g("数据源配置")])),_:1},8,["onClick"])]),_:1})):ie("",!0),_(B)("administrator")?(R(),F(oe,{key:2,content:"将菜单产品包与租户配置绑定",placement:"top","show-arrow":""},{default:t(()=>[e(H,{variant:"outline",onClick:_(de)},{default:t(()=>l[21]||(l[21]=[g("产品包配置")])),_:1},8,["onClick"])]),_:1})):ie("",!0),_(B)("administrator")?(R(),F(oe,{key:3,content:"将自定义的菜单集合定制为租户绑定的菜单产品包",placement:"top","show-arrow":""},{default:t(()=>[e(H,{variant:"outline",onClick:_(re)},{default:t(()=>l[22]||(l[22]=[g("产品包管理")])),_:1},8,["onClick"])]),_:1})):ie("",!0)]),_:1})]),_:1})]),accountNumber:t(({row:d})=>[e(be,{theme:"primary",variant:"light"},{default:t(()=>[g(ge(d.accountNumber>0?d.accountNumber:"不限制"),1)]),_:2},1024)]),expireTime:t(({row:d})=>[e(be,{theme:"primary",variant:"light"},{default:t(()=>[g(ge(d.expireTime?d.expireTime:"不限制"),1)]),_:2},1024)]),op:t(d=>[W((R(),ue("a",{class:"t-button-link",onClick:_e=>f(d,"view")},l[23]||(l[23]=[g("查看")]),8,lt)),[[ae,"tenant_view"]]),W((R(),ue("a",{class:"t-button-link",onClick:_e=>f(d,"edit")},l[24]||(l[24]=[g("编辑")]),8,nt)),[[ae,"tenant_edit"]]),W((R(),ue("a",{class:"t-button-link",onClick:_e=>i(d)},l[25]||(l[25]=[g("删除")]),8,ot)),[[ae,"tenant_delete"]])]),_:1},8,["data","columns","loading","pagination","selected-row-keys","header-affixed-top"]),e(Ue,{visible:u.value,"onUpdate:visible":l[4]||(l[4]=d=>u.value=d),header:"确认删除当前所选数据？","on-cancel":z,onConfirm:w},null,8,["visible"]),e(qe,{visible:y.value,"onUpdate:visible":l[5]||(l[5]=d=>y.value=d),editId:v.value,"onUpdate:editId":l[6]||(l[6]=d=>v.value=d),actionType:C.value,"onUpdate:actionType":l[7]||(l[7]=d=>C.value=d),onSubmit:_(a)},null,8,["visible","editId","actionType","onSubmit"]),e(Qe,{visible:N.value,"onUpdate:visible":l[8]||(l[8]=d=>N.value=d),editId:v.value,"onUpdate:editId":l[9]||(l[9]=d=>v.value=d),onSubmit:_(a)},null,8,["visible","editId","onSubmit"]),e(Oe,{visible:b.value,"onUpdate:visible":l[10]||(l[10]=d=>b.value=d),editId:v.value,"onUpdate:editId":l[11]||(l[11]=d=>v.value=d),onSubmit:_(a)},null,8,["visible","editId","onSubmit"]),e(Je,{visible:E.value,"onUpdate:visible":l[12]||(l[12]=d=>E.value=d),editId:v.value,"onUpdate:editId":l[13]||(l[13]=d=>v.value=d),"tenant-id":Q.value,onSubmit:_(a)},null,8,["visible","editId","tenant-id","onSubmit"]),e(et,{visible:ee.value,"onUpdate:visible":l[14]||(l[14]=d=>ee.value=d)},null,8,["visible"])])],2)}}});export{ct as default};
